<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RED FLAG SafeGuard Pro - ××¢×¨×›×ª ×–×™×”×•×™ ××•×§×“× ×œ×‘×˜×™×—×•×ª ×ª×œ××™×“×™×</title>
    <style>
        /* === ×‘×¡×™×¡ === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #dc2626;
            --primary-dark: #b91c1c;
            --secondary: #991b1b;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
            --info: #0ea5e9;
            --bg-light: #f7fafc;
            --white: #ffffff;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-600: #4b5563;
            --gray-800: #1f2937;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --radius: 12px;
            --radius-lg: 20px;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            min-height: 100vh;
            line-height: 1.6;
            color: var(--gray-800);
        }

        /* === ×¢×™×¦×•×‘×™× ×›×œ×œ×™×™× === */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: white;
        }

        .btn-primary { background: var(--primary); }
        .btn-primary:hover { background: var(--primary-dark); transform: translateY(-1px); }
        .btn-success { background: var(--success); }
        .btn-success:hover { background: #059669; transform: translateY(-1px); }
        .btn-warning { background: var(--warning); }
        .btn-warning:hover { background: #d97706; transform: translateY(-1px); }
        .btn-danger { background: var(--error); }
        .btn-danger:hover { background: #dc2626; transform: translateY(-1px); }
        .btn-secondary { background: var(--gray-600); color: white; }
        .btn-secondary:hover { background: var(--gray-800); transform: translateY(-1px); }
        .btn-info { background: var(--info); }
        .btn-info:hover { background: #0284c7; transform: translateY(-1px); }

        .card {
            background: var(--white);
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
            margin-bottom: 1.5rem;
            border: 2px solid var(--primary);
        }

        .card:hover { transform: translateY(-2px); }

        .status-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
            color: white;
        }

        .status-high { background: var(--error); }
        .status-medium { background: var(--warning); }
        .status-low { background: var(--success); }
        .status-new { background: var(--info); }

        .hidden { display: none !important; }

        /* === ×“×£ ×”×ª×—×‘×¨×•×ª === */
        .login-page {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1rem;
        }

        .login-container {
            background: var(--white);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-xl);
            overflow: hidden;
            width: 100%;
            max-width: 450px;
            animation: slideIn 0.8s ease-out;
            border: 2px solid var(--primary);
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        @keyframes fadeIn { 
            from { opacity: 0; } 
            to { opacity: 1; } 
        }

        .login-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .login-header .logo { 
            font-size: 3rem; 
            margin-bottom: 1rem;
            animation: wave 2s ease-in-out infinite;
        }

        @keyframes wave {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }

        .login-header h1 { 
            font-size: 2rem; 
            margin-bottom: 0.5rem;
            color: white;
        }

        .login-form {
            padding: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            color: var(--gray-800);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .form-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid var(--gray-200);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: all 0.3s ease;
            background: var(--gray-50);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            background: var(--white);
            box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
        }

        .login-btn {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            border-radius: var(--radius);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .quick-login {
            margin-top: 2rem;
            padding: 1.5rem;
            background: var(--gray-50);
            border-radius: var(--radius);
        }

        .quick-btn {
            display: block;
            width: 100%;
            padding: 0.8rem;
            margin-bottom: 0.8rem;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quick-btn:hover { 
            background: var(--primary-dark); 
            transform: translateY(-1px);
        }

        /* === ×”××¤×œ×™×§×¦×™×” ×”×¨××©×™×ª === */
        .app-page {
            display: none;
            background-color: var(--bg-light);
            color: var(--gray-800);
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 1rem 2rem;
            box-shadow: var(--shadow);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: white;
        }

        .navigation {
            background: var(--white);
            border-bottom: 1px solid var(--gray-200);
            padding: 0 2rem;
        }

        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            gap: 2rem;
        }

        .nav-item {
            padding: 1rem 0;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .nav-item:hover,
        .nav-item.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .main-content {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 2rem;
        }

        .page-title {
            font-size: 2rem;
            margin-bottom: 2rem;
            color: var(--gray-800);
        }

        .dashboard-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .dashboard-card {
            background: var(--white);
            border-radius: var(--radius);
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: transform 0.3s ease;
            border: 2px solid var(--primary);
        }

        .dashboard-card:hover { transform: translateY(-2px); }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .card-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--gray-800);
        }

        .card-icon {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .card-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .card-description {
            color: var(--gray-600);
            font-size: 0.9rem;
        }

        .card-danger .card-icon { background: rgba(239, 68, 68, 0.1); color: var(--error); }
        .card-danger .card-value { color: var(--error); }
        .card-warning .card-icon { background: rgba(245, 158, 11, 0.1); color: var(--warning); }
        .card-warning .card-value { color: var(--warning); }
        .card-success .card-icon { background: rgba(16, 185, 129, 0.1); color: var(--success); }
        .card-success .card-value { color: var(--success); }
        .card-info .card-icon { background: rgba(14, 165, 233, 0.1); color: var(--info); }
        .card-info .card-value { color: var(--info); }

        .table-container {
            background: var(--white);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            border: 2px solid var(--primary);
        }

        .table-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--gray-200);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.1), rgba(185, 28, 28, 0.1));
        }

        .table-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--primary);
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th,
        .table td {
            padding: 1rem;
            text-align: right;
            border-bottom: 1px solid var(--gray-200);
        }

        .table th {
            background: var(--gray-100);
            font-weight: 600;
            color: var(--gray-800);
        }

        .table tbody tr:hover {
            background: var(--gray-100);
        }

        .table .btn {
            padding: 0.5rem 1rem;
            font-size: 0.8rem;
            margin-left: 0.5rem;
        }

        .message {
            padding: 1rem;
            border-radius: var(--radius);
            margin-bottom: 1rem;
            font-weight: 500;
            animation: slideDown 0.3s ease;
        }

        .message.error {
            background: rgba(239, 68, 68, 0.1);
            color: var(--error);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .message.success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .message.info {
            background: rgba(14, 165, 233, 0.1);
            color: var(--info);
            border: 1px solid rgba(14, 165, 233, 0.2);
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .feature-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-top: 1rem;
        }

        .demo-highlight {
            border-left: 5px solid var(--primary);
            background: linear-gradient(135deg, rgba(220, 38, 38, 0.05), rgba(185, 28, 28, 0.05));
        }

        /* === ××•×“×œ×™× === */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            max-width: 90%;
            width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            animation: slideIn 0.3s ease;
            border: 2px solid var(--primary);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 1.5rem;
            border-radius: 20px 20px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            color: white;
        }

        .modal-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 1.5rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .modal-body {
            padding: 2rem;
        }

        /* === ×™×™×‘×•× ×§×‘×¦×™× === */
        .file-upload-area {
            border: 2px dashed var(--primary);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            background: rgba(220, 38, 38, 0.05);
            margin: 1rem 0;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .file-upload-area:hover {
            border-color: var(--primary-dark);
            background: rgba(220, 38, 38, 0.1);
            transform: translateY(-2px);
        }

        .file-upload-area.dragover {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: var(--gray-200);
            border-radius: 10px;
            overflow: hidden;
            margin: 1rem 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            transition: width 0.3s ease;
            border-radius: 10px;
        }

        /* === ×ª×•×¦××•×ª ×™×™×‘×•× === */
        .import-results {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), rgba(5, 150, 105, 0.05));
            border: 2px solid var(--success);
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .import-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1rem 0;
        }

        .summary-card {
            text-align: center;
            padding: 1rem;
            background: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            border: 1px solid var(--gray-200);
        }

        .summary-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .summary-label {
            color: var(--gray-600);
            font-size: 0.9rem;
        }

        /* === ×× ×œ×™×˜×™×§×” ××ª×§×“××ª === */
        .analytics-tabs {
            display: flex;
            border-bottom: 2px solid var(--gray-200);
            margin: 2rem 0 1rem 0;
            overflow-x: auto;
        }

        .analytics-tab {
            padding: 1rem 1.5rem;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            white-space: nowrap;
            font-weight: 500;
        }

        .analytics-tab:hover {
            background: var(--gray-50);
        }

        .analytics-tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
            background: rgba(220, 38, 38, 0.05);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .tab-content.active {
            display: block;
        }

        .kpi-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .kpi-card {
            background: linear-gradient(135deg, var(--white), var(--gray-50));
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow);
            border: 1px solid var(--gray-100);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 15px 15px 0 0;
        }

        .kpi-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-lg);
        }

        .kpi-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin: 0.5rem 0;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .kpi-label {
            color: var(--gray-600);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .kpi-change {
            font-size: 0.9rem;
            font-weight: 500;
            margin-top: 0.5rem;
        }

        .kpi-change.positive {
            color: var(--success);
        }

        .insights-panel {
            background: linear-gradient(135deg, var(--info), #0284c7);
            color: white;
            border-radius: 15px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .insights-panel h4 {
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .insight-item {
            padding: 0.75rem;
            margin: 0.5rem 0;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 10px;
            border-left: 4px solid rgba(255, 255, 255, 0.5);
        }

        /* ×¨×¡×¤×•× ×¡×™×‘×™×•×ª */
        @media (max-width: 768px) {
            .dashboard-cards {
                grid-template-columns: 1fr;
            }
            .nav-content {
                overflow-x: auto;
                white-space: nowrap;
            }
            .main-content {
                padding: 0 1rem;
            }
            .modal-content {
                width: 95%;
                margin: 5% auto;
            }
            .kpi-container {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- ×“×£ ×”×ª×—×‘×¨×•×ª -->
    <div id="loginPage" class="login-page">
        <div class="login-container">
            <div class="login-header">
                <div class="logo">ğŸš©</div>
                <h1>RED FLAG SafeGuard Pro</h1>
                <p style="color: white;">××¢×¨×›×ª ×–×™×”×•×™ ××•×§×“× ××ª×§×“××ª ×œ×‘×˜×™×—×•×ª ×ª×œ××™×“×™× - ××‘×•×¡×¡×ª ×¢×œ ××—×§×¨ ××§×¨×” Richardson</p>
                <div style="margin-top: 1rem; font-size: 0.9rem; opacity: 0.9; color: white;">
                    ğŸ” ××¢×¨×›×ª ××‘×˜×—×” ××ª×§×“××ª | ğŸ“Š ×× ×œ×™×˜×™×§×” ×—×›××” ××‘×•×¡×¡×ª ××—×§×¨ Richardson | ğŸ¤– ×ª×•×‘× ×•×ª AI | ğŸ’¾ ×©××™×¨×” ××•×˜×•××˜×™×ª
                </div>
            </div>

            <div class="login-form">
                <div id="messageContainer"></div>

                <!-- ×˜×•×¤×¡ ×”×ª×—×‘×¨×•×ª ×¨×’×™×œ -->
                <form id="loginForm" onsubmit="handleLogin(event)" style="display: block;">
                    <div class="form-group">
                        <label class="form-label" for="username">×©× ××©×ª××©</label>
                        <input type="text" id="username" class="form-input" placeholder="×”×–×Ÿ ×©× ××©×ª××©" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="password">×¡×™×¡××”</label>
                        <input type="password" id="password" class="form-input" placeholder="×”×–×Ÿ ×¡×™×¡××”" required>
                    </div>

                    <button type="submit" class="login-btn">ğŸ”‘ ×”×ª×—×‘×¨ ×œ××¢×¨×›×ª</button>
                </form>

                <!-- ×˜×•×¤×¡ ×”×¨×©××” ×—×“×©×” -->
                <div id="registerForm" class="hidden">
                    <h3 style="margin-bottom: 1rem;">ğŸ“ ×”×¨×©××” ×œ××¢×¨×›×ª</h3>
                    
                    <div class="form-group">
                        <label class="form-label">×©× ××œ×</label>
                        <input type="text" id="newUserName" class="form-input" placeholder="×”×–×Ÿ ×©× ××œ×">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">×ª×¤×§×™×“ ×‘××¢×¨×›×ª</label>
                        <select id="newUserRole" class="form-input">
                            <option value="teacher">××•×¨×”</option>
                            <option value="counselor">×™×•×¢×¥ ×—×™× ×•×›×™</option>
                            <option value="principal">×× ×”×œ/×ª</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">××™××™×™×œ</label>
                        <input type="email" id="newUserEmail" class="form-input" placeholder="user@example.com">
                    </div>
                    
                    <button class="login-btn" onclick="generateOTPCode()">
                        ğŸ“± ×¦×•×¨ ×§×•×“ ×—×“ ×¤×¢××™
                    </button>
                    
                    <div style="text-align: center; margin-top: 1rem;">
                        <a href="#" onclick="showLoginForm()" style="color: var(--primary);">â† ×—×–×•×¨ ×œ×”×ª×—×‘×¨×•×ª</a>
                    </div>
                </div>

                <!-- ×˜×•×¤×¡ ××™××•×ª OTP -->
                <div id="otpForm" class="hidden">
                    <h3 style="margin-bottom: 1rem;">ğŸ” ××™××•×ª ×§×•×“ ×—×“ ×¤×¢××™</h3>
                    
                    <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0; text-align: center;">
                        <p>×§×•×“ ×—×“ ×¤×¢××™ × ×©×œ×— ×œ××™××™×™×œ ×©×œ×š:</p>
                        <div style="font-size: 2rem; font-weight: bold; color: var(--primary); margin: 1rem 0;" id="displayedOTP">
                            123456
                        </div>
                        <p style="font-size: 0.9rem; color: var(--gray-600);">
                            ×œ×¦×•×¨×›×™ ×”×“×’××”, ×”×§×•×“ ××•×¦×’ ×›××Ÿ. ×‘××¢×¨×›×ª ×××™×ª×™×ª ×”×•× ×™×©×œ×— ×œ××™××™×™×œ ×‘×œ×‘×“.
                        </p>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">×”×–×Ÿ ×§×•×“ ××™××•×ª</label>
                        <input type="text" id="otpCode" class="form-input" placeholder="×”×–×Ÿ 6 ×¡×¤×¨×•×ª" maxlength="6">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">×‘×—×¨ ×¡×™×¡××”</label>
                        <input type="password" id="newUserPassword" class="form-input" placeholder="×‘×—×¨ ×¡×™×¡××” ×—×–×§×”">
                    </div>
                    
                    <div style="display: flex; gap: 1rem;">
                        <button class="login-btn" onclick="backToRegister()" style="flex: 1; background: var(--gray-600);">
                            â† ×—×–×•×¨
                        </button>
                        <button class="login-btn" onclick="completeRegistration()" style="flex: 2;">
                            âœ… ×”×©×œ× ×”×¨×©××”
                        </button>
                    </div>
                </div>

                <div class="quick-login">
                    <h3>×›× ×™×¡×” ××”×™×¨×” ×œ××˜×¨×•×ª ×”×“×’××”:</h3>
                    <button class="quick-btn" onclick="quickLogin('××•×¨×” ×¨×—×œ ×›×”×Ÿ', 'teacher')">
                        ğŸ‘©â€ğŸ« ××•×¨×” ×¨×—×œ ×›×”×Ÿ
                    </button>
                    <button class="quick-btn" onclick="quickLogin('×™×•×¢×¥ ×“× ×™ ×œ×•×™', 'counselor')">
                        ğŸ‘¨â€ğŸ’¼ ×™×•×¢×¥ ×“× ×™ ×œ×•×™ (×’×™×©×” ×œ×× ×œ×™×˜×™×§×”)
                    </button>
                    <button class="quick-btn" onclick="quickLogin('×× ×”×œ×ª ×©×¨×” ××‘×¨×”×', 'principal')">
                        ğŸ‘©â€ğŸ’¼ ×× ×”×œ×ª ×©×¨×” ××‘×¨×”× (×”×¨×©××•×ª ××œ××•×ª)
                    </button>
                    <button class="quick-btn" onclick="quickLogin('×× ×”×œ ××¢×¨×›×ª', 'admin')">
                        ğŸ”§ ×× ×”×œ ××¢×¨×›×ª (×’×™×©×” ×œ×›×œ)
                    </button>
                    
                    <div style="border-top: 1px solid var(--gray-200); margin-top: 1rem; padding-top: 1rem;">
                        <h4 style="margin-bottom: 0.5rem;">××©×ª××© ×—×“×©?</h4>
                        <button class="quick-btn" onclick="showRegisterForm()" style="background: var(--success);">
                            â• ×”×¨×©××” ×—×“×©×” ×¢× ×§×•×“ ×—×“ ×¤×¢××™
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ×”××¤×œ×™×§×¦×™×” ×”×¨××©×™×ª -->
    <div id="appPage" class="app-page">
        <header class="header">
            <div class="header-content">
                <div class="logo">ğŸš© RED FLAG SafeGuard Pro</div>
                <div class="user-menu">
                    <span id="userRole" style="font-size: 0.8rem; opacity: 0.8; color: white;"></span>
                    <span id="currentUser" style="color: white;">××©×ª××©</span>
                    <button class="btn btn-secondary" onclick="handleLogout()" style="color: white;">ğŸšª ×™×¦×™××”</button>
                </div>
            </div>
        </header>

        <nav class="navigation">
            <div class="nav-content">
                <div class="nav-item active" onclick="showSection('dashboard')">ğŸ  ×œ×•×— ×‘×§×¨×”</div>
                <div class="nav-item" onclick="showSection('students')">ğŸ‘¥ ×ª×œ××™×“×™×</div>
                <div class="nav-item" onclick="showSection('alerts')">ğŸš¨ ×”×ª×¨××•×ª</div>
                <div class="nav-item" onclick="showSection('analytics')">ğŸ“Š ×× ×œ×™×˜×™×§×” ××ª×§×“××ª</div>
                <div class="nav-item" onclick="showSection('reports')">ğŸ“ˆ ×“×•×—×•×ª</div>
                <div class="nav-item" onclick="showSection('settings')">âš™ï¸ ×”×’×“×¨×•×ª</div>
            </div>
        </nav>

        <main class="main-content">
            <!-- ×œ×•×— ×‘×§×¨×” -->
            <section id="dashboard-section">
                <h1 class="page-title">ğŸ  ×œ×•×— ×‘×§×¨×” ×¨××©×™</h1>
                
                <div class="dashboard-cards">
                    <div class="dashboard-card card-danger">
                        <div class="card-header">
                            <div class="card-title">ğŸš¨ ×”×ª×¨××•×ª ×“×—×•×¤×•×ª</div>
                            <div class="card-icon">âš ï¸</div>
                        </div>
                        <div class="card-value" id="dashboardAlerts">3</div>
                        <div class="card-description">×“×•×¨×©×•×ª ×˜×™×¤×•×œ ××™×™×“×™</div>
                    </div>

                    <div class="dashboard-card card-warning">
                        <div class="card-header">
                            <div class="card-title">âš ï¸ ×ª×œ××™×“×™× ×‘×¡×™×›×•×Ÿ</div>
                            <div class="card-icon">ğŸ‘¥</div>
                        </div>
                        <div class="card-value" id="dashboardRisk">12</div>
                        <div class="card-description">×“×•×¨×©×™× ××¢×§×‘ ×¦××•×“</div>
                    </div>

                    <div class="dashboard-card card-success">
                        <div class="card-header">
                            <div class="card-title">ğŸ‘¥ ×ª×œ××™×“×™× ×‘××¢×¨×›×ª</div>
                            <div class="card-icon">âœ…</div>
                        </div>
                        <div class="card-value" id="dashboardTotal">5</div>
                        <div class="card-description">×¡×”"×› ×ª×œ××™×“×™× ×¤×¢×™×œ×™×</div>
                    </div>

                    <div class="dashboard-card card-info">
                        <div class="card-header">
                            <div class="card-title">ğŸ“Š ×“×•×—×•×ª ×”×©×‘×•×¢</div>
                            <div class="card-icon">ğŸ“ˆ</div>
                        </div>
                        <div class="card-value">8</div>
                        <div class="card-description">×“×•×—×•×ª ×©× ×•×¦×¨×• ×”×©×‘×•×¢</div>
                    </div>
                </div>

                <!-- ×”×“×’××ª ×ª×›×•× ×•×ª ××ª×§×“××•×ª -->
                <div class="card demo-highlight">
                    <div class="card-header">
                        <div class="card-title">ğŸš€ ×ª×›×•× ×•×ª ×”××¢×¨×›×ª ×”××©×•×¤×¨×ª</div>
                    </div>
                    <p><strong>ğŸ”¥ ×—×“×©!</strong> ××¢×¨×›×ª RED FLAG SafeGuard Pro ×¢× ×™×›×•×œ×•×ª ××ª×§×“××•×ª ×œ×–×™×”×•×™ ××•×§×“× ×©×œ ×¡×™×›×•× ×™× ×•×‘×¢×™×•×ª ×‘×˜×™×—×•×ª, ××‘×•×¡×¡×ª ×¢×œ ×œ×§×—×™ ××—×§×¨ ××§×¨×” Richardson ×•××§×¨×™× ×“×•××™×.</p>
                    <div class="feature-buttons">
                        <button class="btn btn-primary" onclick="showSection('students')">
                            ğŸ‘¥ × ×™×”×•×œ ×ª×œ××™×“×™× ××ª×§×“×
                        </button>
                        <button class="btn btn-success" onclick="showImportStudentsModal()">
                            ğŸ“¥ ×™×™×‘×•× ×ª×œ××™×“×™× ×—×›×
                        </button>
                        <button class="btn btn-info" onclick="showSection('analytics')">
                            ğŸ“Š ×× ×œ×™×˜×™×§×” ××ª×§×“××ª
                        </button>
                        <button class="btn btn-warning" onclick="generateQuickReport()">
                            ğŸ“ˆ ×“×•×— ××”×™×¨
                        </button>
                    </div>
                </div>

                <!-- ××—×§×¨ ××§×¨×” Richardson - ×’×•×¨××™ ×¡×™×›×•×Ÿ -->
                <div class="card" style="border: 2px solid #dc2626; background: linear-gradient(135deg, rgba(220, 38, 38, 0.05), rgba(185, 28, 28, 0.05));">
                    <div class="card-header">
                        <div class="card-title" style="color: #dc2626;">ğŸ” ×’×•×¨××™ ×¡×™×›×•×Ÿ ××¨×›×–×™×™× - ××‘×•×¡×¡ ×¢×œ ××—×§×¨ ××§×¨×” Richardson</div>
                    </div>
                    <p style="margin-bottom: 1rem;"><strong>×”××¢×¨×›×ª ××–×”×” ×•×× ×ª×—×ª ×’×•×¨××™ ×¡×™×›×•×Ÿ ×©×–×•×”×• ×‘××—×§×¨ ×”××§×“××™:</strong></p>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                        <div style="padding: 1rem; background: white; border-radius: 8px; border-left: 4px solid #dc2626;">
                            <h4 style="color: #dc2626; margin-bottom: 0.5rem;">ğŸ”´ ×’×•×¨××™× ×¤×¡×™×›×•×œ×•×’×™×™×</h4>
                            <ul style="font-size: 0.9rem; margin: 0; padding-right: 1rem;">
                                <li>×‘×œ×‘×•×œ ×‘×–×”×•×ª ×•×”××¨×“×” ×‘×¡××›×•×ª ×”×•×¨×™×</li>
                                <li>×”×©×¤×¢×” ×©×œ ×“××•×ª ××‘×•×’×¨×ª ×× ×™×¤×•×œ×˜×™×‘×™×ª</li>
                                <li>×¨×•×× ×˜×™×–×¦×™×” ×©×œ ××•×•×ª ×•××œ×™××•×ª</li>
                                <li>× ×˜×™×™×” ×œ××™××¤×•×œ×¡×™×‘×™×•×ª ×•×—×•×¡×¨ ×©×œ×™×˜×” ×¨×’×©×™×ª</li>
                            </ul>
                        </div>
                        
                        <div style="padding: 1rem; background: white; border-radius: 8px; border-left: 4px solid #f59e0b;">
                            <h4 style="color: #f59e0b; margin-bottom: 0.5rem;">ğŸŸ¡ ×”×©×¤×¢×•×ª ×ª×¨×‘×•×ª×™×•×ª</h4>
                            <ul style="font-size: 0.9rem; margin: 0; padding-right: 1rem;">
                                <li>×—×©×™×¤×” ×œ×ª×›× ×™× ××œ×™××™× ×•×¤× ×˜×–×™×•×ª ×—×©×•×›×•×ª</li>
                                <li>×”×©×ª×ª×¤×•×ª ×‘×§×”×™×œ×•×ª ××™× ×˜×¨× ×˜ ×©×•×œ×™×•×ª</li>
                                <li>×–×™×”×•×™ ×¢× ×ª×¨×‘×•×ª ×’×•×ª×™×ª ×•×¢×¨×¤×“×™×ª</li>
                                <li>×˜×©×˜×•×© ×”×’×‘×•×œ ×‘×™×Ÿ ×¤× ×˜×–×™×” ×œ××¦×™××•×ª</li>
                            </ul>
                        </div>
                        
                        <div style="padding: 1rem; background: white; border-radius: 8px; border-left: 4px solid #0ea5e9;">
                            <h4 style="color: #0ea5e9; margin-bottom: 0.5rem;">ğŸ”µ ×’×•×¨××™× ×—×‘×¨×ª×™×™×</h4>
                            <ul style="font-size: 0.9rem; margin: 0; padding-right: 1rem;">
                                <li>×§×©×¨×™× ×œ× ××ª××™××™× ×¢× ×‘×•×’×¨×™×</li>
                                <li>×‘×™×“×•×“ ×—×‘×¨×ª×™ ×•×—×•×¡×¨ ×ª××™×›×” ×¢××™×ª×™×</li>
                                <li>×›×©×œ×™× ×‘××¢×¨×›×•×ª ×”×–×™×”×•×™ ×”××•×§×“×</li>
                                <li>×—×•×¡×¨ ×ª×§×©×•×¨×ª ×¤×ª×•×—×” ×¢× ×”×•×¨×™× ×•××—× ×›×™×</li>
                            </ul>
                        </div>
                    </div>

                    <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(220, 38, 38, 0.1); border-radius: 8px;">
                        <h4 style="color: #dc2626; margin-bottom: 0.5rem;">ğŸ’¡ ×›×™×¦×“ ×”××¢×¨×›×ª ××ª××•×“×“×ª ×¢× ×’×•×¨××™× ××œ×•:</h4>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; font-size: 0.9rem;">
                            <div>
                                <strong>ğŸ¤– × ×™×ª×•×— ×”×ª× ×”×’×•×ª×™ ×—×›×:</strong> ×–×™×”×•×™ ×“×¤×•×¡×™ ×”×ª× ×”×’×•×ª ×—×¨×™×’×™× ×•×©×™× ×•×™×™× ×‘××¦×‘ ×¨×•×—
                            </div>
                            <div>
                                <strong>ğŸŒ ××¢×§×‘ ×“×™×’×™×˜×œ×™:</strong> × ×™×˜×•×¨ ×¤×¢×™×œ×•×ª ××§×•×•× ×ª ×•×—×©×™×¤×” ×œ×ª×›× ×™× ××¡×•×›× ×™×
                            </div>
                            <div>
                                <strong>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ×©×™×ª×•×£ ××©×¤×—×•×ª:</strong> ×©×™×œ×•×‘ ×”×•×¨×™× ×‘×ª×”×œ×™×š ×”×–×™×”×•×™ ×•×”×˜×™×¤×•×œ
                            </div>
                            <div>
                                <strong>ğŸš¨ ×”×ª×¨××•×ª ××•×§×“××•×ª:</strong> ×–×™×”×•×™ ××”×™×¨ ×©×œ ×¡×™×˜×•××¦×™×•×ª ×¡×™×›×•×Ÿ ×•×ª×’×•×‘×” ××™×™×“×™×ª
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ×˜×‘×œ×ª ×”×ª×¨××•×ª ××—×¨×•× ×•×ª -->
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">ğŸš¨ ×”×ª×¨××•×ª ××—×¨×•× ×•×ª</div>
                        <button class="btn btn-primary" onclick="showSection('alerts')">×¦×¤×” ×‘×›×œ ×”×”×ª×¨××•×ª</button>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>×ª×œ××™×“</th>
                                <th>×¡×•×’ ×”×ª×¨××”</th>
                                <th>×¨××ª ×—×•××¨×”</th>
                                <th>×–××Ÿ</th>
                                <th>×¤×¢×•×œ×•×ª</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>×©×¨×” ××¨×˜×™× ×¡</td>
                                <td>×‘×¢×™×” ×—×‘×¨×ª×™×ª</td>
                                <td><span class="status-badge status-high">×’×‘×•×”</span></td>
                                <td>21/01/2024 08:30</td>
                                <td>
                                    <button class="btn btn-primary" onclick="viewStudentProfile('sarah_martins')">ğŸ‘ï¸ ×¦×¤×”</button>
                                    <button class="btn btn-success" onclick="resolveAlert('sarah_martins')">âœ… ×¤×ª×•×¨</button>
                                </td>
                            </tr>
                            <tr>
                                <td>×“×•×“ ×œ×•×™</td>
                                <td>×‘×¢×™×” ×”×ª× ×”×’×•×ª×™×ª</td>
                                <td><span class="status-badge status-medium">×‘×™× ×•× ×™</span></td>
                                <td>20/01/2024 11:45</td>
                                <td>
                                    <button class="btn btn-primary" onclick="viewStudentProfile('david_levi')">ğŸ‘ï¸ ×¦×¤×”</button>
                                    <button class="btn btn-success" onclick="resolveAlert('david_levi')">âœ… ×¤×ª×•×¨</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- ××¢×§×‘ ×ª×œ××™×“×™× -->
            <section id="students-section" class="hidden">
                <h1 class="page-title">ğŸ‘¥ × ×™×”×•×œ ×ª×œ××™×“×™×</h1>
                
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">ğŸ“‹ ×¨×©×™××ª ×ª×œ××™×“×™×</div>
                        <div>
                            <button class="btn btn-success" onclick="showImportStudentsModal()">ğŸ“¥ ×™×™×‘×•× ×ª×œ××™×“×™×</button>
                            <button class="btn btn-primary" onclick="showAddStudentModal()">â• ×”×•×¡×£ ×ª×œ××™×“</button>
                        </div>
                    </div>
                    <div id="studentsTableBody">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>×©× ×”×ª×œ××™×“</th>
                                    <th>×›×™×ª×”</th>
                                    <th>×¨××ª ×¡×™×›×•×Ÿ</th>
                                    <th>×¢×“×›×•×Ÿ ××—×¨×•×Ÿ</th>
                                    <th>×¤×¢×•×œ×•×ª</th>
                                </tr>
                            </thead>
                            <tbody id="studentsTableRows">
                                <tr>
                                    <td>×©×¨×” ××¨×˜×™× ×¡</td>
                                    <td>×›×™×ª×” ×–</td>
                                    <td><span class="status-badge status-high">×’×‘×•×”</span></td>
                                    <td>21/01/2024 10:30</td>
                                    <td>
                                        <button class="btn btn-primary" onclick="viewStudentProfile('sarah_martins')">ğŸ‘ï¸ ×¦×¤×”</button>
                                        <button class="btn btn-warning" onclick="editStudent('sarah_martins')">âœï¸ ×¢×¨×•×š</button>
                                        <button class="btn btn-info" onclick="showEditAlertsModal('sarah_martins')">ğŸš¨ ×”×ª×¨××•×ª</button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>×“×•×“ ×œ×•×™</td>
                                    <td>×›×™×ª×” ×—</td>
                                    <td><span class="status-badge status-medium">×‘×™× ×•× ×™</span></td>
                                    <td>20/01/2024 14:20</td>
                                    <td>
                                        <button class="btn btn-primary" onclick="viewStudentProfile('david_levi')">ğŸ‘ï¸ ×¦×¤×”</button>
                                        <button class="btn btn-warning" onclick="editStudent('david_levi')">âœï¸ ×¢×¨×•×š</button>
                                        <button class="btn btn-info" onclick="showEditAlertsModal('david_levi')">ğŸš¨ ×”×ª×¨××•×ª</button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- × ×™×”×•×œ ×”×ª×¨××•×ª -->
            <section id="alerts-section" class="hidden">
                <h1 class="page-title">ğŸš¨ × ×™×”×•×œ ×”×ª×¨××•×ª</h1>
                
                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">ğŸ“‹ ×›×œ ×”×”×ª×¨××•×ª</div>
                        <button class="btn btn-primary" onclick="showCreateAlertModal()">ğŸš¨ ×¦×•×¨ ×”×ª×¨××” ×—×“×©×”</button>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>×ª×œ××™×“</th>
                                <th>×¡×•×’ ×”×ª×¨××”</th>
                                <th>×—×•××¨×”</th>
                                <th>×¡×˜×˜×•×¡</th>
                                <th>× ×•×¦×¨</th>
                                <th>×¤×¢×•×œ×•×ª</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>×©×¨×” ××¨×˜×™× ×¡</td>
                                <td>×‘×¢×™×” ×—×‘×¨×ª×™×ª</td>
                                <td><span class="status-badge status-high">×’×‘×•×”</span></td>
                                <td><span class="status-badge status-new">×—×“×©</span></td>
                                <td>21/01/2024 08:30</td>
                                <td>
                                    <button class="btn btn-primary" onclick="viewStudentProfile('sarah_martins')">ğŸ‘ï¸ ×¦×¤×”</button>
                                    <button class="btn btn-success" onclick="resolveAlert('sarah_martins')">âœ… ×¤×ª×•×¨</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- ×× ×œ×™×˜×™×§×” ××ª×§×“××ª -->
            <section id="analytics-section" class="hidden">
                <h1 class="page-title">ğŸ“Š ×× ×œ×™×˜×™×§×” ××ª×§×“××ª ×•×ª×•×‘× ×•×ª AI - ××‘×•×¡×¡ ×¢×œ ××—×§×¨ Richardson</h1>
                
                <!-- KPI ××ª×§×“××™× -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">ğŸ¯ ××“×“×™ ×‘×™×¦×•×¢ ××¨×›×–×™×™× (KPI)</div>
                        <button class="btn btn-primary" onclick="refreshAnalytics()">ğŸ”„ ×¨×¢× ×Ÿ × ×ª×•× ×™×</button>
                    </div>
                    
                    <div class="kpi-container">
                        <div class="kpi-card">
                            <div class="kpi-label">×¦×™×•×Ÿ ×‘×˜×™×—×•×ª ×›×œ×œ×™</div>
                            <div class="kpi-value" id="kpiSafety">96</div>
                            <div class="kpi-change positive" id="kpiSafetyChange">â†— +3.2% ××”×—×•×“×© ×©×¢×‘×¨</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">×–××Ÿ ×ª×’×•×‘×” ×××•×¦×¢</div>
                            <div class="kpi-value" id="kpiResponse">0.9</div>
                            <div class="kpi-change positive" id="kpiResponseChange">×©×¢×•×ª â†— ×©×™×¤×•×¨ ×©×œ 25%</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">×©×‘×™×¢×•×ª ×¨×¦×•×Ÿ</div>
                            <div class="kpi-value" id="kpiSatisfaction">4.9</div>
                            <div class="kpi-change positive" id="kpiSatisfactionChange">â­ +0.4 ××”×—×•×“×© ×©×¢×‘×¨</div>
                        </div>
                        <div class="kpi-card">
                            <div class="kpi-label">×“×™×•×§ ×—×™×–×•×™ AI</div>
                            <div class="kpi-value" id="kpiAI">94.7</div>
                            <div class="kpi-change positive" id="kpiAIChange">% â†— ×©×™×¤×•×¨ ×©×œ 8%</div>
                        </div>
                    </div>
                </div>

                <!-- ×ª×•×‘× ×•×ª ×—×›××•×ª ××‘×•×¡×¡×•×ª AI -->
                <div class="insights-panel">
                    <h4>ğŸ¤– ×ª×•×‘× ×•×ª ×—×›××•×ª ××‘×•×¡×¡×•×ª AI - ×œ×§×—×™ ××—×§×¨ Richardson</h4>
                    <div class="insight-item" id="insight1">
                        ğŸ’¡ ×–×•×”×” ×§×©×¨ ×—×–×§ ×‘×™×Ÿ ×™×¨×™×“×” ×‘× ×•×›×—×•×ª ×œ×¢×œ×™×™×” ×‘×”×ª×¨××•×ª - ××§×“× ×§×•×¨×œ×¦×™×”: 0.73 (×“×•××” ×œ×ª×•×¤×¢×•×ª ×©×–×•×”×• ×‘××§×¨×” Richardson)
                    </div>
                    <div class="insight-item" id="insight2">
                        ğŸ“Š ×ª×œ××™×“×™× ×¢× ×—×©×™×¤×” ×œ×ª×›× ×™× ×’×•×ª×™×™×/××œ×™××™× ××¨××™× ×¡×™×›×•×Ÿ ××•×’×‘×¨ ×¤×™ 2.3 ×œ×”×ª× ×”×’×•×ª ×—×¨×™×’×”
                    </div>
                    <div class="insight-item" id="insight3">
                        âš ï¸ ×—×™×–×•×™: ×§×©×¨×™× ×œ× ××ª××™××™× ×¢× ×‘×•×’×¨×™× ××”×•×•×™× ×’×•×¨× ×¡×™×›×•×Ÿ ××¨×›×–×™ - ×–×•×”×• 4 ××§×¨×™× ×“×•××™× ×‘×—×•×“×© ×”×§×¨×•×‘
                    </div>
                    <div class="insight-item" id="insight4">
                        ğŸ¯ ×”××œ×¦×” ××‘×•×¡×¡×ª ××—×§×¨: ×–×™×”×•×™ ××•×§×“× ×©×œ ×©×™× ×•×™×™× ×‘×–×”×•×ª ×•×‘×”×ª× ×”×’×•×ª ×™×›×•×œ ×œ×× ×•×¢ 87% ××”××§×¨×™× ×”×§×™×¦×•× ×™×™×
                    </div>
                    <div class="insight-item">
                        ğŸ” ×œ×§×— ××¨×›×–×™ ×××§×¨×” Richardson: ×©×™×œ×•×‘ ××¢×§×‘ ×“×™×’×™×˜×œ×™ ×¢× ×”×ª×¢×¨×‘×•×ª ××©×¤×—×ª×™×ª ××•×§×“××ª ×”×•× ×”××¤×ª×— ×œ×× ×™×¢×”
                    </div>
                </div>

                <!-- ×˜××‘×™ ×× ×œ×™×˜×™×§×” -->
                <div class="card">
                    <div class="analytics-tabs">
                        <div class="analytics-tab active" onclick="showAnalyticsTab('overview')">ğŸ” ×¡×§×™×¨×” ×›×œ×œ×™×ª</div>
                        <div class="analytics-tab" onclick="showAnalyticsTab('trends')">ğŸ“ˆ ××’××•×ª ×•×ª×—×–×™×•×ª</div>
                        <div class="analytics-tab" onclick="showAnalyticsTab('performance')">ğŸ“ ×‘×™×¦×•×¢×™× ××§×“××™×™×</div>
                        <div class="analytics-tab" onclick="showAnalyticsTab('behavior')">ğŸ­ × ×™×ª×•×— ×”×ª× ×”×’×•×ª</div>
                    </div>

                    <!-- ×ª×•×›×Ÿ ×˜××‘×™× -->
                    <div id="overview-tab" class="tab-content active">
                        <h4>ğŸ“Š ×¡×§×™×¨×” ×›×œ×œ×™×ª ×©×œ ×”××¢×¨×›×ª - ××‘×•×¡×¡×ª ×¢×œ ××—×§×¨ Richardson</h4>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1rem 0;">
                            <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; text-align: center;">
                                <h4>×”×ª×¤×œ×’×•×ª ×¡×™×›×•× ×™×</h4>
                                <div style="color: var(--error); font-size: 1.5rem; font-weight: bold;">20%</div>
                                <div>×¡×™×›×•×Ÿ ×’×‘×•×”</div>
                            </div>
                            <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; text-align: center;">
                                <h4>×–×™×”×•×™ ×§×©×¨×™× ××¡×•×›× ×™×</h4>
                                <div style="color: var(--warning); font-size: 1.5rem; font-weight: bold;">3</div>
                                <div>××§×¨×™× ×–×•×”×• ×”×©×‘×•×¢</div>
                            </div>
                            <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; text-align: center;">
                                <h4>×“×™×•×§ ×—×™×–×•×™ Richardson-Based</h4>
                                <div style="color: var(--info); font-size: 1.5rem; font-weight: bold;">94.7%</div>
                                <div>××œ×’×•×¨×™×ª× AI</div>
                            </div>
                        </div>
                        
                        <div style="background: rgba(220, 38, 38, 0.1); padding: 1rem; border-radius: 8px; margin: 1rem 0; border-left: 4px solid #dc2626;">
                            <h5 style="color: #dc2626;">ğŸ” ×’×•×¨××™ ×¡×™×›×•×Ÿ ××¨×›×–×™×™× ×©×”××¢×¨×›×ª ××–×”×”:</h5>
                            <ul style="margin: 0.5rem 0; font-size: 0.9rem;">
                                <li><strong>×¤×¡×™×›×•×œ×•×’×™×™×:</strong> ×‘×œ×‘×•×œ ×–×”×•×ª, ×”×©×¤×¢×” ×× ×™×¤×•×œ×˜×™×‘×™×ª, ×¨×•×× ×˜×™×–×¦×™×” ×©×œ ××œ×™××•×ª</li>
                                <li><strong>×ª×¨×‘×•×ª×™×™×:</strong> ×—×©×™×¤×” ×œ×ª×›× ×™× ×§×™×¦×•× ×™×™×, ×”×©×ª×ª×¤×•×ª ×‘×§×”×™×œ×•×ª ×©×•×œ×™×•×ª</li>
                                <li><strong>×—×‘×¨×ª×™×™×:</strong> ×§×©×¨×™× ×œ× ××ª××™××™×, ×‘×™×“×•×“, ×›×©×œ×™ ×ª×§×©×•×¨×ª ××©×¤×—×ª×™×ª</li>
                            </ul>
                        </div>
                    </div>

                    <div id="trends-tab" class="tab-content">
                        <h4>ğŸ“ˆ ××’××•×ª ×•×ª×—×–×™×•×ª ××ª×§×“××•×ª</h4>
                        <p>× ×™×ª×•×— ××’××•×ª ×œ×˜×•×•×— ××¨×•×š ××‘×•×¡×¡ ×¢×œ × ×ª×•× ×™× ×”×™×¡×˜×•×¨×™×™× ×•××œ×’×•×¨×™×ª××™ ×œ××™×“×ª ××›×•× ×”.</p>
                        <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                            <h5>ğŸ”® ×ª×—×–×™×•×ª ×œ×—×•×“×© ×”×§×¨×•×‘:</h5>
                            <ul style="margin: 0.5rem 0;">
                                <li>×¦×¤×•×™ ×©×™×¤×•×¨ ×©×œ 12% ×‘×¨××ª ×”×‘×˜×™×—×•×ª ×”×›×œ×œ×™×ª</li>
                                <li>3-4 ×ª×œ××™×“×™× × ×•×¡×¤×™× ×¢×œ×•×œ×™× ×œ×¢×‘×•×¨ ×œ×¨××ª ×¡×™×›×•×Ÿ ×‘×™× ×•× ×™</li>
                                <li>×”××œ×¦×” ×œ×”×’×‘×™×¨ ××¢×§×‘ ×‘×›×™×ª×•×ª ×–-×—</li>
                            </ul>
                        </div>
                    </div>

                    <div id="performance-tab" class="tab-content">
                        <h4>ğŸ“ × ×™×ª×•×— ×‘×™×¦×•×¢×™× ××§×“××™×™×</h4>
                        <p>××¢×§×‘ ××¤×•×¨×˜ ××—×¨ ×”×™×©×’×™× ××§×“××™×™× ×•×§×©×¨ ×œ×¨××•×ª ×¡×™×›×•×Ÿ.</p>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin: 1rem 0;">
                            <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px;">
                                <h5>ğŸ“š ×××•×¦×¢ ×›×œ×œ×™</h5>
                                <div style="font-size: 2rem; color: var(--success);">83.2</div>
                            </div>
                            <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px;">
                                <h5>ğŸ“ˆ ××’××ª ×©×™×¤×•×¨</h5>
                                <div style="font-size: 2rem; color: var(--info);">+2.4%</div>
                            </div>
                        </div>
                    </div>

                    <div id="behavior-tab" class="tab-content">
                        <h4>ğŸ­ × ×™×ª×•×— ×”×ª× ×”×’×•×ª×™ ××ª×§×“× - ×œ×§×—×™ ××§×¨×” Richardson</h4>
                        <p>×–×™×”×•×™ ×“×¤×•×¡×™ ×”×ª× ×”×’×•×ª ×•××™×¨×•×¢×™× ×—×¨×™×’×™× ×‘×××¦×¢×•×ª ×‘×™× ×” ××œ××›×•×ª×™×ª ××‘×•×¡×¡×ª ××—×§×¨.</p>
                        <div style="background: var(--gray-50); padding: 1rem; border-radius: 8px; margin: 1rem 0;">
                            <h5>ğŸš¨ ×”×ª×¨××•×ª ×”×ª× ×”×’×•×ª×™×•×ª ×”×©×‘×•×¢ (××‘×•×¡×¡ Richardson Research):</h5>
                            <ul style="margin: 0.5rem 0;">
                                <li><strong>2 ××§×¨×™ ×–×™×”×•×™ ×§×©×¨×™× ×—×©×•×“×™×</strong> - ×§×©×¨ ×¢× ×‘×•×’×¨×™× ×“×¨×š ×¨×©×ª×•×ª ×—×‘×¨×ª×™×•×ª</li>
                                <li><strong>3 ××§×¨×™ ×©×™× ×•×™ ×“×¨×¡×˜×™ ×‘×”×ª× ×”×’×•×ª</strong> - ×”×¤×¨×¢×” ×‘×©×™×¢×•×¨ ×•× ×¡×™×’×” ×—×‘×¨×ª×™×ª</li>
                                <li><strong>1 ××§×¨×” ×©×œ ×—×©×™×¤×” ×œ×ª×›× ×™× ×§×™×¦×•× ×™×™×</strong> - ×ª×›× ×™× ×’×•×ª×™×™×/××œ×™××™× ×‘×¨×©×ª</li>
                                <li><strong>2 ××§×¨×™ ×‘×™×“×•×“ ×—×‘×¨×ª×™</strong> - × ×× ×¢×™× ××¤×¢×™×œ×•×™×•×ª ×§×‘×•×¦×ª×™×•×ª</li>
                            </ul>
                        </div>
                        
                        <div style="background: rgba(220, 38, 38, 0.1); padding: 1rem; border-radius: 8px; border-left: 4px solid #dc2626;">
                            <h5 style="color: #dc2626;">ğŸ” ××•×“×œ Richardson - ×’×•×¨××™ ×¡×™×›×•×Ÿ ××¨×›×–×™×™×:</h5>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-top: 0.5rem;">
                                <div>
                                    <strong>×¤×¡×™×›×•×œ×•×’×™×™×:</strong>
                                    <ul style="font-size: 0.9rem; margin: 0.5rem 0;">
                                        <li>×‘×œ×‘×•×œ ×–×”×•×ª ×•×”××¨×“×”</li>
                                        <li>×”×©×¤×¢×” ×× ×™×¤×•×œ×˜×™×‘×™×ª</li>
                                        <li>×¨×•×× ×˜×™×–×¦×™×” ×©×œ ××•×•×ª</li>
                                    </ul>
                                </div>
                                <div>
                                    <strong>×—×‘×¨×ª×™×™×:</strong>
                                    <ul style="font-size: 0.9rem; margin: 0.5rem 0;">
                                        <li>×§×©×¨×™× ×œ× ××ª××™××™×</li>
                                        <li>×‘×™×“×•×“ ××¢××™×ª×™×</li>
                                        <li>×›×©×œ×™ ×ª×§×©×•×¨×ª ××©×¤×—×ª×™×ª</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ×›×œ×™ ×× ×œ×™×˜×™×§×” ××ª×§×“××™× -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">ğŸ”§ ×›×œ×™ ×× ×œ×™×˜×™×§×” ××ª×§×“××™×</div>
                    </div>
                    <div class="feature-buttons">
                        <button class="btn btn-primary" onclick="generatePredictiveAnalysis()">
                            ğŸ”® × ×™×ª×•×— ×—×™×–×•×™
                        </button>
                        <button class="btn btn-success" onclick="generateCorrelationAnalysis()">
                            ğŸ”— × ×™×ª×•×— ×§×•×¨×œ×¦×™×”
                        </button>
                        <button class="btn btn-warning" onclick="generateAnomalyDetection()">
                            ğŸš¨ ×–×™×”×•×™ ×—×¨×™×’×•×ª
                        </button>
                        <button class="btn btn-info" onclick="exportAnalyticsData()">
                            ğŸ’¾ ×™×™×¦×•× × ×ª×•× ×™×
                        </button>
                    </div>
                </div>
            </section>

            <!-- ×“×•×—×•×ª -->
            <section id="reports-section" class="hidden">
                <h1 class="page-title">ğŸ“ˆ ×“×•×—×•×ª ×•×× ×œ×™×˜×™×§×” - ××‘×•×¡×¡×ª ××—×§×¨ Richardson</h1>
                
                <div class="dashboard-cards">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">ğŸ“ˆ ×“×•×— ×©×‘×•×¢×™</div>
                            <div class="card-icon">ğŸ“Š</div>
                        </div>
                        <p>×“×•×— ××¤×•×¨×˜ ×¢×œ ×¤×¢×™×œ×•×ª ×”×©×‘×•×¢ ×”× ×•×›×—×™</p>
                        <br>
                        <button class="btn btn-primary" onclick="generateWeeklyReport()">ğŸ“ˆ ×¦×•×¨ ×“×•×— ×©×‘×•×¢×™</button>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">ğŸ“Š ×“×•×— ×—×•×“×©×™</div>
                            <div class="card-icon">ğŸ“ˆ</div>
                        </div>
                        <p>×¡×™×›×•× ×—×•×“×©×™ ×©×œ ×›×œ ×”×¤×¢×™×œ×•×™×•×ª</p>
                        <br>
                        <button class="btn btn-primary" onclick="generateMonthlyReport()">ğŸ“Š ×¦×•×¨ ×“×•×— ×—×•×“×©×™</button>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">âš¡ ×“×•×— ××”×™×¨</div>
                            <div class="card-icon">âš¡</div>
                        </div>
                        <p>×¡×™×›×•× ××”×™×¨ ×©×œ ×”××¦×‘ ×”× ×•×›×—×™</p>
                        <br>
                        <button class="btn btn-warning" onclick="generateQuickReport()">âš¡ ×“×•×— ××”×™×¨</button>
                    </div>
                </div>
            </section>

            <!-- ×”×’×“×¨×•×ª -->
            <section id="settings-section" class="hidden">
                <h1 class="page-title">âš™ï¸ ×”×’×“×¨×•×ª ××¢×¨×›×ª</h1>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">ğŸ’¾ × ×™×”×•×œ × ×ª×•× ×™×</div>
                    </div>
                    
                    <div style="margin-bottom: 2rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border-left: 4px solid var(--success);">
                        <h4 style="margin-bottom: 0.5rem; color: var(--success);">ğŸ’¡ ××¢×¨×›×ª RED FLAG SafeGuard Pro:</h4>
                        <p style="margin: 0;">
                            <strong>××¢×¨×›×ª ××ª×§×“××ª ×”××‘×•×¡×¡×ª ×¢×œ ××—×§×¨ ××§×¨×” Richardson ×•××§×¨×™× ×“×•××™×!</strong><br>
                            â€¢ ×›×œ ×™×™×‘×•× ×ª×œ××™×“×™× × ×©××¨ ×¢× × ×™×ª×•×— ×’×•×¨××™ ×¡×™×›×•×Ÿ<br>
                            â€¢ ×›×œ ×”×ª×¨××” ×—×“×©×” × ×•×ª×—×ª ×œ×¤×™ ××•×“×œ Richardson<br>
                            â€¢ ×”× ×ª×•× ×™× × ×˜×¢× ×™× ××•×˜×•××˜×™×ª ×¢× ××œ×’×•×¨×™×ª××™ AI ××©×•×¤×¨×™×<br>
                            â€¢ ×”××¢×¨×›×ª ×œ×•××“×ª ×•××©×ª×¤×¨×ª ×¢×œ ×‘×¡×™×¡ ××—×§×¨ ×¤×¡×™×›×•×œ×•×’×™ ×•××©×¤×˜×™
                        </p>
                    </div>

                    <div style="margin-bottom: 2rem; padding: 1rem; background: rgba(14, 165, 233, 0.1); border-radius: 8px; border-left: 4px solid var(--info);">
                        <h4 style="margin-bottom: 0.5rem; color: var(--info);">â„¹ï¸ ××¦×‘ ×”× ×ª×•× ×™×:</h4>
                        <div id="dataStatusInfo">
                            <div><strong>×¡×”"×› ×ª×œ××™×“×™×:</strong> <span id="totalStudentsCount">5</span></div>
                            <div><strong>×¡×”"×› ×”×ª×¨××•×ª:</strong> <span id="totalAlertsCount">0</span></div>
                            <div><strong>×©××™×¨×” ××—×¨×•× ×”:</strong> <span id="lastSaveTime">×˜×¨× × ×©××¨</span></div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 2rem;">
                        <button class="btn btn-success" onclick="saveDataToStorage()">
                            ğŸ’¾ ×©××•×¨ × ×ª×•× ×™× ×™×“× ×™×ª
                        </button>
                        <button class="btn btn-info" onclick="loadDataFromStorage()">
                            ğŸ“¥ ×˜×¢×Ÿ × ×ª×•× ×™× ×©××•×¨×™×
                        </button>
                        <button class="btn btn-danger" onclick="confirmClearData()">
                            ğŸ—‘ï¸ × ×§×” ××ª ×›×œ ×”× ×ª×•× ×™×
                        </button>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- ××•×“×œ ×™×™×‘×•× ×ª×œ××™×“×™× ××©×•×¤×¨ -->
    <div id="importStudentsModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸ“¥ ×™×™×‘×•× ×ª×œ××™×“×™× ××§×•×‘×¥ Excel</h2>
                <button class="modal-close" onclick="closeImportModal()">&times;</button>
            </div>

            <div class="modal-body">
                <!-- ×”×¡×‘×¨ ×¢×œ ×”×™×™×‘×•× -->
                <div style="margin-bottom: 2rem; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 8px; border-left: 4px solid var(--success);">
                    <h4 style="margin-bottom: 0.5rem; color: var(--success);">ğŸ’¡ ×™×™×‘×•× ×ª×œ××™×“×™× ×—×›×:</h4>
                    <p style="margin: 0;">
                        <strong>1. ×”×•×¨×“ ×§×•×‘×¥ ××“×’×</strong> - ×§×•×‘×¥ ×¢× 120 ×ª×œ××™×“×™× ×œ×”×“×’××” ××”×™×¨×”<br>
                        <strong>2. ×”×¢×œ×” ×§×•×‘×¥ ×©×œ×š</strong> - ×§×•×‘×¥ Excel ××©×œ×š ×¢× × ×ª×•× ×™ ×”×ª×œ××™×“×™×<br>
                        <strong>3. ×ª×¦×•×’×” ××§×“×™××”</strong> - ×‘×“×•×§ ××ª ×”× ×ª×•× ×™× ×œ×¤× ×™ ×”×™×™×‘×•×<br>
                        <br>
                        <strong>ğŸ”’ ×”× ×ª×•× ×™× × ×©××¨×™× ××•×˜×•××˜×™×ª!</strong>
                    </p>
                </div>

                <!-- ××–×•×¨ ×”×•×¨×“×ª ×§×•×‘×¥ ××•×›×Ÿ -->
                <div class="card" style="margin-bottom: 2rem;">
                    <div class="card-header">
                        <div class="card-title">ğŸ¯ ×”×“×’××” ××”×™×¨×” - ×”×•×¨×“ ×§×•×‘×¥ ××“×’×</div>
                    </div>
                    <p style="margin-bottom: 1rem;">
                        ×œ×—×¥ ×›××Ÿ ×›×“×™ ×œ×”×•×¨×™×“ ×§×•×‘×¥ Excel ×¢× 120 ×ª×œ××™×“×™× ××•×›× ×™× ×œ×”×“×’××”. 
                        ×”×§×•×‘×¥ ×™×›×™×œ ×©××•×ª, ×›×™×ª×•×ª, ×¤×¨×˜×™ ×”×•×¨×™× ×•×›×œ ×”× ×ª×•× ×™× ×”× ×“×¨×©×™×.
                    </p>
                    <button class="btn btn-info" onclick="downloadExcelTemplate()">
                        ğŸ“¥ ×”×•×¨×“ ×§×•×‘×¥ ××“×’× (120 ×ª×œ××™×“×™×)
                    </button>
                </div>

                <!-- ××–×•×¨ ×”×¢×œ××ª ×§×•×‘×¥ -->
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">ğŸ“ ×”×¢×œ××ª ×§×•×‘×¥ Excel</div>
                    </div>
                    <p style="margin-bottom: 1rem;">
                        ×’×¨×•×¨ ×§×•×‘×¥ Excel ×œ×›××Ÿ ××• ×œ×—×¥ ×œ×‘×—×™×¨×”. ×”×§×•×‘×¥ ×—×™×™×‘ ×œ×›×œ×•×œ ××ª ×”×¢××•×“×•×ª: 
                        <strong>×©× ×¤×¨×˜×™, ×©× ××©×¤×—×”, ××¡×¤×¨ ×–×”×•×ª, ×›×™×ª×”, ×©× ×”×•×¨×”, ×˜×œ×¤×•×Ÿ ×”×•×¨×”</strong>
                    </p>
                    
                    <div class="file-upload-area" id="fileUploadArea" onclick="document.getElementById('excelFileInput').click()">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">ğŸ“</div>
                        <h3>×’×¨×•×¨ ×§×•×‘×¥ Excel ×œ×›××Ÿ ××• ×œ×—×¥ ×œ×‘×—×™×¨×”</h3>
                        <p style="color: var(--gray-600); margin-top: 0.5rem;">×ª×•××š ×‘×§×‘×¦×™ .xlsx, .xls (×¢×“ 10MB)</p>
                    </div>
                    
                    <input type="file" id="excelFileInput" style="display: none;" accept=".xlsx,.xls" onchange="handleExcelFileSelect(event)">
                </div>

                <!-- ×‘×¨ ×”×ª×§×“××•×ª -->
                <div id="progressContainer" class="hidden" style="margin: 1rem 0;">
                    <h4>××¢×‘×“ ×§×•×‘×¥...</h4>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%;"></div>
                    </div>
                    <div id="progressText" style="text-align: center; margin-top: 0.5rem;">0%</div>
                </div>

                <!-- ×ª×•×¦××•×ª ×™×™×‘×•× -->
                <div id="importResultsContainer" class="hidden">
                    <div class="import-results">
                        <h3 style="color: var(--success); margin-bottom: 1rem;">âœ… ×§×•×‘×¥ × ×•×ª×— ×‘×”×¦×œ×—×”!</h3>
                        
                        <div class="import-summary" id="importSummary">
                            <!-- × ×ª×•× ×™× ×™×ª×•×•×¡×¤×• ×›××Ÿ -->
                        </div>
                        
                        <div style="margin-top: 1.5rem; display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                            <button class="btn btn-info" onclick="viewImportedStudents()">
                                ğŸ‘ï¸ ×ª×¦×•×’×” ××§×“×™××” ××œ××”
                            </button>
                            <button class="btn btn-success" onclick="proceedWithImport()">
                                âœ… ×”××©×š - ×™×™×‘× ×œ××¢×¨×›×ª
                            </button>
                            <button class="btn btn-secondary" onclick="resetImport()">
                                ğŸ”„ ×”×ª×—×œ ××—×“×©
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ×›×¤×ª×•×¨×™ ×¤×¢×•×œ×” ×ª×—×ª×•× ×™× -->
                <div style="margin-top: 2rem; display: flex; gap: 1rem; justify-content: space-between;">
                    <button class="btn btn-info" onclick="showImportInstructions()">
                        â“ ×”×•×¨××•×ª ××¤×•×¨×˜×•×ª
                    </button>
                    <button class="btn btn-secondary" onclick="closeImportModal()">
                        âŒ ×¡×’×•×¨
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ××•×“×œ ×ª×¦×•×’×” ××§×“×™××” ×©×œ ×ª×œ××™×“×™× -->
    <div id="previewStudentsModal" class="modal hidden">
        <div class="modal-content" style="width: 1000px;">
            <div class="modal-header">
                <h2>ğŸ‘¥ ×ª×¦×•×’×” ××§×“×™××” - ×ª×œ××™×“×™× ×œ×™×™×‘×•×</h2>
                <button class="modal-close" onclick="closePreviewModal()">&times;</button>
            </div>

            <div class="modal-body">
                <div style="margin-bottom: 1rem; padding: 1rem; background: var(--gray-50); border-radius: 8px;">
                    <h4>ğŸ“Š ×¡×™×›×•×:</h4>
                    <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-top: 1rem;">
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--primary);" id="previewTotal">0</div>
                            <div>×¡×”"×› ×ª×œ××™×“×™×</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--error);" id="previewHigh">0</div>
                            <div>×¡×™×›×•×Ÿ ×’×‘×•×”</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--warning);" id="previewMedium">0</div>
                            <div>×¡×™×›×•×Ÿ ×‘×™× ×•× ×™</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 1.5rem; font-weight: bold; color: var(--success);" id="previewLow">0</div>
                            <div>×¡×™×›×•×Ÿ × ××•×š</div>
                        </div>
                    </div>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">ğŸ“‹ ×¨×©×™××ª ×”×ª×œ××™×“×™× ×œ×™×™×‘×•× (50 ×¨××©×•× ×™×)</div>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>×©× ×”×ª×œ××™×“</th>
                                <th>×›×™×ª×”</th>
                                <th>×××•×¦×¢</th>
                                <th>× ×•×›×—×•×ª</th>
                                <th>×¨××ª ×¡×™×›×•×Ÿ</th>
                                <th>×˜×œ×¤×•×Ÿ ×”×•×¨×”</th>
                            </tr>
                        </thead>
                        <tbody id="previewTableBody">
                            <!-- ×ª×•×›×Ÿ ×”×ª×œ××™×“×™× ×™×ª×•×•×¡×£ ×›××Ÿ -->
                        </tbody>
                    </table>
                </div>

                <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem; flex-wrap: wrap;">
                    <button class="btn btn-secondary" onclick="closePreviewModal()">
                        âŒ ×¡×’×•×¨
                    </button>
                    <button class="btn btn-success" onclick="confirmImportFromPreview()">
                        âœ… ××™×©×•×¨ ×•×™×™×‘×•× ×œ××¢×¨×›×ª
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ××•×“×œ ×”×•×¡×¤×ª ×ª×œ××™×“ ×—×“×© -->
    <div id="addStudentModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>â• ×”×•×¡×¤×ª ×ª×œ××™×“ ×—×“×©</h2>
                <button class="modal-close" onclick="closeAddStudentModal()">&times;</button>
            </div>

            <div class="modal-body">
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">×©× ×¤×¨×˜×™ *</label>
                        <input type="text" id="newStudentFirstName" class="form-input" placeholder="×©× ×¤×¨×˜×™">
                    </div>
                    <div class="form-group">
                        <label class="form-label">×©× ××©×¤×—×” *</label>
                        <input type="text" id="newStudentLastName" class="form-input" placeholder="×©× ××©×¤×—×”">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">××¡×¤×¨ ×–×”×•×ª *</label>
                        <input type="text" id="newStudentId" class="form-input" placeholder="123456789" maxlength="9">
                    </div>
                    <div class="form-group">
                        <label class="form-label">×›×™×ª×” *</label>
                        <select id="newStudentGrade" class="form-input">
                            <option value="">×‘×—×¨ ×›×™×ª×”</option>
                            <option value="×–">×›×™×ª×” ×–</option>
                            <option value="×—">×›×™×ª×” ×—</option>
                            <option value="×˜">×›×™×ª×” ×˜</option>
                            <option value="×™">×›×™×ª×” ×™</option>
                            <option value="×™×">×›×™×ª×” ×™×</option>
                            <option value="×™×‘">×›×™×ª×” ×™×‘</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">×›×ª×•×‘×ª</label>
                    <input type="text" id="newStudentAddress" class="form-input" placeholder="×¨×—×•×‘ ×”×¨×¦×œ 15, ×ª×œ ××‘×™×‘">
                </div>

                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">×©× ×”×•×¨×”/××¤×•×˜×¨×•×¤×•×¡</label>
                        <input type="text" id="newStudentParentName" class="form-input" placeholder="×©× ×”×”×•×¨×”">
                    </div>
                    <div class="form-group">
                        <label class="form-label">×˜×œ×¤×•×Ÿ ×”×•×¨×”</label>
                        <input type="text" id="newStudentParentPhone" class="form-input" placeholder="050-1234567">
                    </div>
                </div>

                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                    <div class="form-group">
                        <label class="form-label">×××•×¦×¢ ×¦×™×•× ×™×</label>
                        <input type="number" id="newStudentGradeAvg" class="form-input" placeholder="85" min="0" max="100">
                    </div>
                    <div class="form-group">
                        <label class="form-label">××—×•×– × ×•×›×—×•×ª</label>
                        <input type="number" id="newStudentAttendance" class="form-input" placeholder="95" min="0" max="100">
                    </div>
                    <div class="form-group">
                        <label class="form-label">×¨××ª ×¡×™×›×•×Ÿ</label>
                        <select id="newStudentRisk" class="form-input">
                            <option value="low">× ××•×š</option>
                            <option value="medium">×‘×™× ×•× ×™</option>
                            <option value="high">×’×‘×•×”</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">×”×¢×¨×•×ª × ×•×¡×¤×•×ª</label>
                    <textarea id="newStudentNotes" class="form-input" rows="3" placeholder="×”×¢×¨×•×ª ×¢×œ ×”×ª×œ××™×“..."></textarea>
                </div>

                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button class="btn btn-secondary" onclick="closeAddStudentModal()">
                        âŒ ×‘×™×˜×•×œ
                    </button>
                    <button class="btn btn-success" onclick="saveNewStudent()">
                        âœ… ×©××•×¨ ×ª×œ××™×“
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ××•×“×œ ×¢×¨×™×›×ª ×”×ª×¨××•×ª -->
    <div id="editAlertsModal" class="modal hidden">
        <div class="modal-content" style="width: 1000px;">
            <div class="modal-header">
                <h2>âœï¸ ×¢×¨×™×›×ª ×”×ª×¨××•×ª - <span id="editAlertsStudentName">×ª×œ××™×“</span></h2>
                <button class="modal-close" onclick="closeEditAlertsModal()">&times;</button>
            </div>

            <div class="modal-body">
                <div style="margin-bottom: 2rem;">
                    <button class="btn btn-primary" onclick="addNewAlertToStudent()">
                        ğŸš¨ ×”×•×¡×£ ×”×ª×¨××” ×—×“×©×”
                    </button>
                </div>

                <div class="table-container">
                    <div class="table-header">
                        <div class="table-title">ğŸ“‹ ×”×ª×¨××•×ª ×§×™×™××•×ª</div>
                    </div>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>×¡×•×’</th>
                                <th>×›×•×ª×¨×ª</th>
                                <th>×—×•××¨×”</th>
                                <th>×¡×˜×˜×•×¡</th>
                                <th>× ×•×¦×¨</th>
                                <th>×¤×¢×•×œ×•×ª</th>
                            </tr>
                        </thead>
                        <tbody id="studentAlertsTableBody">
                            <!-- ×”×ª×¨××•×ª ×™×ª×•×•×¡×¤×• ×›××Ÿ -->
                        </tbody>
                    </table>
                </div>

                <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 2rem;">
                    <button class="btn btn-secondary" onclick="closeEditAlertsModal()">
                        âŒ ×¡×’×•×¨
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ××•×“×œ ×™×¦×™×¨×ª ×”×ª×¨××” ×—×“×©×” -->
    <div id="createAlertModal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ğŸš¨ ×™×¦×™×¨×ª ×”×ª×¨××” ×—×“×©×”</h2>
                <button class="modal-close" onclick="closeCreateAlertModal()">&times;</button>
            </div>

            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">×‘×—×¨ ×ª×œ××™×“</label>
                    <select id="alertStudentSelect" class="form-input">
                        <option value="">-- ×‘×—×¨ ×ª×œ××™×“ --</option>
                        <option value="sarah_martins">×©×¨×” ××¨×˜×™× ×¡ (×›×™×ª×” ×–)</option>
                        <option value="david_levi">×“×•×“ ×œ×•×™ (×›×™×ª×” ×—)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">×¡×•×’ ×”×ª×¨××”</label>
                    <select id="alertType" class="form-input">
                        <option value="academic">×‘×¢×™×” ××§×“××™×ª</option>
                        <option value="behavior">×‘×¢×™×” ×”×ª× ×”×’×•×ª×™×ª</option>
                        <option value="social">×‘×¢×™×” ×—×‘×¨×ª×™×ª</option>
                        <option value="attendance">×‘×¢×™×™×ª × ×•×›×—×•×ª</option>
                        <option value="health">×‘×¢×™×” ×‘×¨×™××•×ª×™×ª</option>
                        <option value="family">×‘×¢×™×” ××©×¤×—×ª×™×ª</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">×¨××ª ×—×•××¨×”</label>
                    <div style="display: flex; gap: 1rem;">
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="radio" name="severity" value="low" style="margin: 0;">
                            <span class="status-badge status-low">× ××•×›×”</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="radio" name="severity" value="medium" style="margin: 0;" checked>
                            <span class="status-badge status-medium">×‘×™× ×•× ×™×ª</span>
                        </label>
                        <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                            <input type="radio" name="severity" value="high" style="margin: 0;">
                            <span class="status-badge status-high">×’×‘×•×”×”</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">×›×•×ª×¨×ª ×”×”×ª×¨××”</label>
                    <input type="text" id="alertTitle" class="form-input" placeholder="×ª×Ÿ ×›×•×ª×¨×ª ×§×¦×¨×” ×œ×”×”×ª×¨××”">
                </div>

                <div class="form-group">
                    <label class="form-label">×ª×™××•×¨ ××¤×•×¨×˜</label>
                    <textarea id="alertDescription" class="form-input" rows="4" placeholder="×ª××¨ ××ª ×”×‘×¢×™×” ×‘×¤×™×¨×•×˜..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label">×¤×¢×•×œ×•×ª ××•××œ×¦×•×ª</label>
                    <textarea id="alertActions" class="form-input" rows="3" placeholder="××™×œ×• ×¤×¢×•×œ×•×ª ×›×“××™ ×œ× ×§×•×˜?"></textarea>
                </div>

                <div style="display: flex; gap: 1rem; justify-content: flex-end;">
                    <button class="btn btn-secondary" onclick="closeCreateAlertModal()">
                        âŒ ×‘×™×˜×•×œ
                    </button>
                    <button class="btn btn-danger" onclick="submitNewAlert()">
                        ğŸš¨ ×¦×•×¨ ×”×ª×¨××”
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ××•×“×œ ×“×•×— -->
    <div id="reportModal" class="modal hidden">
        <div class="modal-content" style="width: 900px;">
            <div class="modal-header">
                <h2 id="reportModalTitle">ğŸ“Š ×“×•×— ××¤×•×¨×˜</h2>
                <button class="modal-close" onclick="closeReportModal()">&times;</button>
            </div>

            <div class="modal-body">
                <div id="reportContent">
                    <!-- ×ª×•×›×Ÿ ×”×“×•×— ×™×ª×•×•×¡×£ ×›××Ÿ -->
                </div>
                
                <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 2rem;">
                    <button class="btn btn-secondary" onclick="closeReportModal()">
                        âŒ ×¡×’×•×¨
                    </button>
                    <button class="btn btn-success" onclick="downloadReport()">
                        ğŸ’¾ ×”×•×¨×“ ×“×•×—
                    </button>
                    <button class="btn btn-info" onclick="emailReport()">
                        ğŸ“§ ×©×œ×— ×‘××™××™×™×œ
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

    <script>
        // === ××©×ª× ×™× ×’×œ×•×‘×œ×™×™× ===
        let currentUser = null;
        let importedStudentsData = []; // ××©×ª× ×” ×œ×©××™×¨×ª × ×ª×•× ×™ ×™×™×‘×•×
        let systemAlerts = []; // ××©×ª× ×” ×œ×©××™×¨×ª ×”×ª×¨××•×ª ×”××¢×¨×›×ª
        let generatedOTP = null; // ××©×ª× ×” ×œ×©××™×¨×ª ×§×•×“ ×—×“ ×¤×¢××™
        
        // ××¢×¨×›×ª ×©××™×¨×ª × ×ª×•× ×™×
        let persistentData = {
            students: {},
            alerts: [],
            lastImportDate: null,
            totalStudentsImported: 0
        };

        // × ×ª×•× ×™ ×ª×œ××™×“×™× ×œ×“××•
        const studentsData = {
            'sarah_martins': {
                id: 'sarah_martins',
                firstName: '×©×¨×”',
                lastName: '××¨×˜×™× ×¡', 
                grade: '×–',
                studentId: '123456789',
                riskLevel: 'high',
                avatar: 'ğŸ‘§',
                lastUpdate: '21/01/2024 10:30',
                personalInfo: {
                    birthDate: '15/03/2010',
                    address: '×¨×—×•×‘ ×”×“×¡ 12, ×ª×œ ××‘×™×‘',
                    phone: '03-1234567',
                    parentName: '×“×™× ×” ××¨×˜×™× ×¡',
                    parentPhone: '050-1234567'
                },
                academicInfo: {
                    averageGrade: 78,
                    attendance: 85,
                    subjects: [
                        { name: '××ª××˜×™×§×”', grade: 75, trend: 'down' },
                        { name: '×¢×‘×¨×™×ª', grade: 82, trend: 'stable' },
                        { name: '×× ×’×œ×™×ª', grade: 88, trend: 'up' },
                        { name: '××“×¢×™×', grade: 70, trend: 'down' }
                    ]
                },
                behaviorInfo: {
                    incidents: 3,
                    lastIncident: '18/01/2024',
                    notes: '××¨××” ×¡×™×× ×™ ×‘×“×™×“×•×ª ×•× ×¡×™×’×” ×—×‘×¨×ª×™×ª'
                },
                alerts: [
                    {
                        id: 'alert_001',
                        type: 'social',
                        severity: 'high',
                        status: 'new',
                        title: '×‘×“×™×“×•×ª ×—×‘×¨×ª×™×ª',
                        description: '×”×ª×œ××™×“×” × ×× ×¢×ª ××¤×¢×™×œ×•×™×•×ª ×—×‘×¨×ª×™×•×ª ×•××‘×œ×” ×œ×‘×“×” ×‘×”×¤×¡×§×•×ª',
                        createdAt: '21/01/2024 08:30',
                        createdBy: '××•×¨×” ×¨×—×œ ×›×”×Ÿ'
                    }
                ]
            },
            'david_levi': {
                id: 'david_levi',
                firstName: '×“×•×“',
                lastName: '×œ×•×™',
                grade: '×—',
                studentId: '987654321',
                riskLevel: 'medium',
                avatar: 'ğŸ‘¦',
                lastUpdate: '20/01/2024 14:20',
                personalInfo: {
                    birthDate: '22/07/2009',
                    address: '×¨×—×•×‘ ×”×¨×¦×œ 45, ×¨××ª ×’×Ÿ',
                    phone: '03-9876543',
                    parentName: '××©×” ×œ×•×™',
                    parentPhone: '052-9876543'
                },
                academicInfo: {
                    averageGrade: 82,
                    attendance: 92,
                    subjects: [
                        { name: '××ª××˜×™×§×”', grade: 85, trend: 'up' },
                        { name: '×¢×‘×¨×™×ª', grade: 78, trend: 'stable' },
                        { name: '×× ×’×œ×™×ª', grade: 80, trend: 'stable' },
                        { name: '××“×¢×™×', grade: 88, trend: 'up' }
                    ]
                },
                behaviorInfo: {
                    incidents: 2,
                    lastIncident: '15/01/2024',
                    notes: '×‘×¢×™×•×ª ×§×œ×•×ª ×‘×”×ª× ×”×’×•×ª, ××¤×¨×™×¢ ××“×™ ×¤×¢× ×‘×©×™×¢×•×¨'
                },
                alerts: [
                    {
                        id: 'alert_003',
                        type: 'behavior',
                        severity: 'medium',
                        status: 'in_progress',
                        title: '×”×¤×¨×¢×” ×‘×©×™×¢×•×¨',
                        description: '××¤×¨×™×¢ ×œ×—×‘×¨×™× ×‘×›×™×ª×” ×•××§×©×” ×¢×œ ×”××•×¨×” ×œ×”××©×™×š ×‘×©×™×¢×•×¨',
                        createdAt: '20/01/2024 11:45',
                        createdBy: '××•×¨×” ×¨×—×œ ×›×”×Ÿ'
                    }
                ]
            }
        };

        // === ×¤×•× ×§×¦×™×•×ª ×©××™×¨×” ×•×˜×¢×™× ×” ===
        function saveDataToStorage() {
            persistentData.students = { ...studentsData };
            persistentData.alerts = [...systemAlerts];
            persistentData.lastImportDate = new Date().toLocaleString('he-IL');
            persistentData.totalStudentsImported = Object.keys(studentsData).length;
            updateDataStatus();
            showAppMessage('ğŸ’¾ ×”× ×ª×•× ×™× × ×©××¨×• ×‘×”×¦×œ×—×”!', 'success');
        }

        function loadDataFromStorage() {
            if (persistentData.students && Object.keys(persistentData.students).length > 0) {
                Object.assign(studentsData, persistentData.students);
                systemAlerts.splice(0, systemAlerts.length, ...persistentData.alerts);
                
                if (persistentData.lastImportDate) {
                    showAppMessage(`ğŸ“¥ × ×ª×•× ×™× × ×˜×¢× ×•! ××—×¨×•×Ÿ ×™×™×‘×•×: ${persistentData.lastImportDate} (${persistentData.totalStudentsImported} ×ª×œ××™×“×™×)`, 'info');
                }
                return true;
            }
            return false;
        }

        function confirmClearData() {
            if (confirm('âš ï¸ ×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×›×œ ×”× ×ª×•× ×™×? ×¤×¢×•×œ×” ×–×• ×œ× × ×™×ª× ×ª ×œ×‘×™×˜×•×œ!')) {
                if (confirm('ğŸ”´ ×–×•×”×™ ×”×–×“×× ×•×ª ××—×¨×•× ×”! ×”×× ××ª×” ×‘×˜×•×— ×œ×—×œ×•×˜×™×Ÿ?')) {
                    persistentData = {
                        students: {},
                        alerts: [],
                        lastImportDate: null,
                        totalStudentsImported: 0
                    };
                    
                    // × ×™×§×•×™ ×”××©×ª× ×™× ×”×’×œ×•×‘×œ×™×™× ××‘×œ ×©××™×¨×” ×¢×œ ×”×ª×œ××™×“×™× ×”××§×•×¨×™×™×
                    Object.keys(studentsData).forEach(key => {
                        if (key !== 'sarah_martins' && key !== 'david_levi') {
                            delete studentsData[key];
                        }
                    });
                    systemAlerts.length = 0;
                    
                    showAppMessage('ğŸ—‘ï¸ ×›×œ ×”× ×ª×•× ×™× × ×•×§×• ××”××¢×¨×›×ª!', 'success');
                    updateDataStatus();
                    updateStudentsTable();
                    updateDashboardStats();
                }
            }
        }

        function updateDataStatus() {
            const totalStudents = Object.keys(studentsData).length;
            const totalAlerts = systemAlerts.length;
            const lastSave = persistentData.lastImportDate || '×˜×¨× × ×©××¨';
            
            const totalElement = document.getElementById('totalStudentsCount');
            const alertsElement = document.getElementById('totalAlertsCount');
            const saveElement = document.getElementById('lastSaveTime');
            
            if (totalElement) totalElement.textContent = totalStudents;
            if (alertsElement) alertsElement.textContent = totalAlerts;
            if (saveElement) saveElement.textContent = lastSave;
        }

        // === ×¤×•× ×§×¦×™×•×ª ×”×ª×—×‘×¨×•×ª ===
        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();

            if (!username || !password) {
                showMessage('×™×© ×œ××œ× ×©× ××©×ª××© ×•×¡×™×¡××”', 'error');
                return;
            }

            showMessage('××ª×—×‘×¨ ×œ××¢×¨×›×ª...', 'info');
            setTimeout(() => {
                currentUser = {
                    username: username,
                    name: username,
                    role: 'user'
                };
                showApp();
            }, 1000);
        }

        function quickLogin(name, role) {
            currentUser = {
                username: name,
                name: name,
                role: role
            };
            
            showMessage(`×©×œ×•× ${name}! ××ª×—×‘×¨ ×œ××¢×¨×›×ª...`, 'success');
            setTimeout(() => showApp(), 1000);
        }

        function showApp() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('appPage').style.display = 'block';
            
            document.getElementById('currentUser').textContent = currentUser.name;
            document.getElementById('userRole').textContent = currentUser.role || '××©×ª××©';
            
            showSection('dashboard');
            showAppMessage(`ğŸ‰ ×‘×¨×•×›×™× ×”×‘××™× ×œ××¢×¨×›×ª RED FLAG SafeGuard Pro!`, 'success');
            updateDashboardStats();
            loadDataFromStorage();
        }

        function handleLogout() {
            if (confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×”×ª× ×ª×§ ××”××¢×¨×›×ª?')) {
                currentUser = null;
                document.getElementById('appPage').style.display = 'none';
                document.getElementById('loginPage').style.display = 'flex';
                document.getElementById('loginForm').reset();
                document.getElementById('messageContainer').innerHTML = '';
                showLoginForm();
                showMessage('×™×¦××ª ××”××¢×¨×›×ª ×‘×”×¦×œ×—×”! ğŸ‘‹', 'success');
            }
        }

        // === ×¤×•× ×§×¦×™×•×ª ×”×¨×©××” ===
        function showLoginForm() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('registerForm').classList.add('hidden');
            document.getElementById('otpForm').classList.add('hidden');
            clearMessages();
        }

        function showRegisterForm() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').classList.remove('hidden');
            document.getElementById('otpForm').classList.add('hidden');
            clearMessages();
        }

        function generateOTPCode() {
            const name = document.getElementById('newUserName').value.trim();
            const email = document.getElementById('newUserEmail').value.trim();
            const role = document.getElementById('newUserRole').value;

            if (!name || !email) {
                showMessage('âŒ ×™×© ×œ××œ× ×©× ×•××™××™×™×œ', 'error');
                return;
            }

            if (!email.includes('@')) {
                showMessage('âŒ ×›×ª×•×‘×ª ××™××™×™×œ ×œ× ×ª×§×™× ×”', 'error');
                return;
            }

            // ×™×¦×™×¨×ª ×§×•×“ ×—×“ ×¤×¢××™
            generatedOTP = Math.floor(100000 + Math.random() * 900000).toString();
            
            showMessage('ğŸ“± ××™×™×¦×¨ ×§×•×“ ×—×“ ×¤×¢××™...', 'info');
            
            setTimeout(() => {
                document.getElementById('displayedOTP').textContent = generatedOTP;
                document.getElementById('registerForm').classList.add('hidden');
                document.getElementById('otpForm').classList.remove('hidden');
                showMessage('âœ… ×§×•×“ ×—×“ ×¤×¢××™ × ×•×¦×¨! ×‘×“×•×§ ××ª ×”××™××™×™×œ ×©×œ×š', 'success');
            }, 2000);
        }

        function backToRegister() {
            document.getElementById('registerForm').classList.remove('hidden');
            document.getElementById('otpForm').classList.add('hidden');
        }

        function completeRegistration() {
            const enteredOTP = document.getElementById('otpCode').value.trim();
            const password = document.getElementById('newUserPassword').value.trim();
            const name = document.getElementById('newUserName').value.trim();
            const role = document.getElementById('newUserRole').value;

            if (!enteredOTP || !password) {
                showMessage('âŒ ×™×© ×œ××œ× ×§×•×“ ××™××•×ª ×•×¡×™×¡××”', 'error');
                return;
            }

            if (enteredOTP !== generatedOTP) {
                showMessage('âŒ ×§×•×“ ×”××™××•×ª ×©×’×•×™', 'error');
                return;
            }

            if (password.length < 4) {
                showMessage('âŒ ×”×¡×™×¡××” ×—×™×™×‘×ª ×œ×”×›×™×œ ×œ×¤×—×•×ª 4 ×ª×•×•×™×', 'error');
                return;
            }

            showMessage('âœ… × ×¨×©××ª ×‘×”×¦×œ×—×”! ××ª×—×‘×¨ ×œ××¢×¨×›×ª...', 'success');
            
            setTimeout(() => {
                currentUser = {
                    username: name,
                    name: name,
                    role: role
                };
                showApp();
            }, 2000);
        }

        function clearMessages() {
            document.getElementById('messageContainer').innerHTML = '';
        }

        // === × ×™×•×•×˜ ===
        function showSection(sectionName) {
            document.querySelectorAll('main section').forEach(section => {
                section.classList.add('hidden');
            });
            
            const targetSection = document.getElementById(`${sectionName}-section`);
            if (targetSection) {
                targetSection.classList.remove('hidden');
            }
            
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });
            
            const navItems = document.querySelectorAll('.nav-item');
            const sectionNames = ['dashboard', 'students', 'alerts', 'analytics', 'reports', 'settings'];
            const sectionIndex = sectionNames.indexOf(sectionName);
            
            if (sectionIndex !== -1 && navItems[sectionIndex]) {
                navItems[sectionIndex].classList.add('active');
            }

            // ××ª×—×•×œ × ×ª×•× ×™× ×¡×¤×¦×™×¤×™×™× ×œ×›×œ ×¢××•×“
            if (sectionName === 'students') {
                setTimeout(() => {
                    updateStudentsTable();
                }, 100);
            } else if (sectionName === 'dashboard') {
                setTimeout(() => {
                    updateDashboardStats();
                }, 100);
            } else if (sectionName === 'settings') {
                setTimeout(() => {
                    updateDataStatus();
                }, 100);
            } else if (sectionName === 'analytics') {
                setTimeout(() => {
                    updateKPICards();
                    updateAIInsights();
                    showAnalyticsTab('overview');
                }, 100);
            }
        }

        // === ×× ×œ×™×˜×™×§×” ××ª×§×“××ª ===
        function showAnalyticsTab(tabName) {
            document.querySelectorAll('#analytics-section .tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.querySelectorAll('#analytics-section .analytics-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            document.getElementById(`${tabName}-tab`).classList.add('active');
            event.target.classList.add('active');
        }

        function refreshAnalytics() {
            showAppMessage('ğŸ”„ ××¨×¢× ×Ÿ × ×ª×•× ×™ ×× ×œ×™×˜×™×§×”...', 'info');
            
            setTimeout(() => {
                updateKPICards();
                updateAIInsights();
                showAppMessage('âœ… ×”× ×ª×•× ×™× ×¢×•×“×›× ×• ×‘×”×¦×œ×—×”!', 'success');
            }, 1500);
        }

        function updateKPICards() {
            const studentsArray = Object.values(studentsData);
            const totalStudents = studentsArray.length;
            
            // ×—×™×©×•×‘ ×¦×™×•×Ÿ ×‘×˜×™×—×•×ª ×¢×œ ×‘×¡×™×¡ ×¨××•×ª ×¡×™×›×•×Ÿ
            const highRisk = studentsArray.filter(s => s.riskLevel === 'high').length;
            const mediumRisk = studentsArray.filter(s => s.riskLevel === 'medium').length;
            const safetyScore = Math.round(100 - ((highRisk * 10 + mediumRisk * 5) / totalStudents * 10));
            
            // ×—×™×©×•×‘ ×–××Ÿ ×ª×’×•×‘×” ×××•×¦×¢
            const responseTime = Math.max(0.5, 2 - (highRisk / totalStudents));
            
            // ×—×™×©×•×‘ ×©×‘×™×¢×•×ª ×¨×¦×•×Ÿ
            const avgGrade = studentsArray.length > 0 ? 
                studentsArray.reduce((sum, s) => sum + (s.academicInfo?.averageGrade || 75), 0) / studentsArray.length : 80;
            const satisfaction = Math.min(5, (avgGrade / 20) + 1);
            
            // ×“×™×•×§ AI
            const lowRisk = totalStudents - highRisk - mediumRisk;
            const aiAccuracy = Math.round(85 + (lowRisk / totalStudents * 15));
            
            // ×¢×“×›×•×Ÿ ×”×›×¨×˜×™×¡×™×
            const kpiSafety = document.getElementById('kpiSafety');
            const kpiResponse = document.getElementById('kpiResponse');
            const kpiSatisfaction = document.getElementById('kpiSatisfaction');
            const kpiAI = document.getElementById('kpiAI');
            
            if (kpiSafety) {
                kpiSafety.textContent = safetyScore;
                document.getElementById('kpiSafetyChange').textContent = `â†— +${Math.round(Math.random() * 5 + 1)}.${Math.floor(Math.random() * 10)}% ××”×—×•×“×© ×©×¢×‘×¨`;
            }
            if (kpiResponse) {
                kpiResponse.textContent = responseTime.toFixed(1);
                document.getElementById('kpiResponseChange').textContent = `×©×¢×•×ª â†— ×©×™×¤×•×¨ ×©×œ ${Math.round(15 + Math.random() * 20)}%`;
            }
            if (kpiSatisfaction) {
                kpiSatisfaction.textContent = satisfaction.toFixed(1);
                document.getElementById('kpiSatisfactionChange').textContent = `â­ +0.${Math.floor(Math.random() * 5 + 1)} ××”×—×•×“×© ×©×¢×‘×¨`;
            }
            if (kpiAI) {
                kpiAI.textContent = aiAccuracy + '.0';
                document.getElementById('kpiAIChange').textContent = `% â†— ×©×™×¤×•×¨ ×©×œ ${Math.round(5 + Math.random() * 10)}%`;
            }
        }

        function updateAIInsights() {
            const studentsArray = Object.values(studentsData);
            const totalStudents = studentsArray.length;
            const highRisk = studentsArray.filter(s => s.riskLevel === 'high').length;
            const mediumRisk = studentsArray.filter(s => s.riskLevel === 'medium').length;
            
            // ×¢×“×›×•×Ÿ ×”×ª×•×‘× ×•×ª ×”×—×›××•×ª
            const insight1 = document.getElementById('insight1');
            const insight2 = document.getElementById('insight2');
            const insight3 = document.getElementById('insight3');
            const insight4 = document.getElementById('insight4');
            
            if (insight1) {
                const correlation = (0.5 + (highRisk / totalStudents) * 0.4).toFixed(2);
                insight1.textContent = `ğŸ’¡ ×–×•×”×” ×§×©×¨ ×‘×™×Ÿ ×™×¨×™×“×” ×‘× ×•×›×—×•×ª ×œ×¢×œ×™×™×” ×‘×”×ª×¨××•×ª - ××§×“× ×§×•×¨×œ×¦×™×”: ${correlation} (×“×•××” ×œ×ª×•×¤×¢×•×ª ×©×–×•×”×• ×‘××§×¨×” Richardson)`;
            }
            
            if (insight2) {
                insight2.textContent = `ğŸ“Š ×ª×œ××™×“×™× ×¢× ×—×©×™×¤×” ×œ×ª×›× ×™× ×’×•×ª×™×™×/××œ×™××™× ××¨××™× ×¡×™×›×•×Ÿ ××•×’×‘×¨ ×¤×™ 2.3 ×œ×”×ª× ×”×’×•×ª ×—×¨×™×’×”`;
            }
            
            if (insight3) {
                insight3.textContent = `âš ï¸ ×—×™×–×•×™: ×§×©×¨×™× ×œ× ××ª××™××™× ×¢× ×‘×•×’×¨×™× ××”×•×•×™× ×’×•×¨× ×¡×™×›×•×Ÿ ××¨×›×–×™ - ×–×•×”×• 4 ××§×¨×™× ×“×•××™× ×‘×—×•×“×© ×”×§×¨×•×‘`;
            }
            
            if (insight4) {
                insight4.textContent = `ğŸ¯ ×”××œ×¦×” ××‘×•×¡×¡×ª ××—×§×¨: ×–×™×”×•×™ ××•×§×“× ×©×œ ×©×™× ×•×™×™× ×‘×–×”×•×ª ×•×‘×”×ª× ×”×’×•×ª ×™×›×•×œ ×œ×× ×•×¢ 87% ××”××§×¨×™× ×”×§×™×¦×•× ×™×™×`;
            }
        }

        function generatePredictiveAnalysis() {
            showAppMessage('ğŸ”® ××¨×™×¥ × ×™×ª×•×— ×—×™×–×•×™ ××ª×§×“×...', 'info');
            
            setTimeout(() => {
                const studentsArray = Object.values(studentsData);
                const totalStudents = studentsArray.length;
                const currentHighRisk = studentsArray.filter(s => s.riskLevel === 'high').length;
                
                showAppMessage(`âœ… × ×™×ª×•×— ×—×™×–×•×™ ×”×•×©×œ×! 
                
ğŸ“Š ×ª×—×–×™×•×ª ××‘×•×¡×¡×•×ª AI:
â€¢ ${Math.round(currentHighRisk * 0.8)} ×ª×œ××™×“×™× ×¦×¤×•×™×™× ×œ×”×©×ª×¤×¨
â€¢ ${Math.round(Math.random() * 3 + 1)} ×ª×œ××™×“×™× ×—×“×©×™× ×‘×¡×™×›×•×Ÿ ×¤×•×˜× ×¦×™××œ×™
â€¢ ×¨××ª ×•×“××•×ª: ${Math.round(85 + Math.random() * 10)}%`, 'success');
            }, 3000);
        }

        function generateCorrelationAnalysis() {
            showAppMessage('ğŸ”— ××‘×¦×¢ × ×™×ª×•×— ×§×•×¨×œ×¦×™×” ×‘×™×Ÿ ×’×•×¨××™× ×©×•× ×™×...', 'info');
            
            setTimeout(() => {
                showAppMessage('âœ… × ×™×ª×•×— ×§×•×¨×œ×¦×™×” ×”×•×©×œ×! × ××¦××• ×§×©×¨×™× ×—×–×§×™× ×‘×™×Ÿ × ×•×›×—×•×ª, ×¦×™×•× ×™× ×•×”×ª× ×”×’×•×ª', 'success');
            }, 2500);
        }

        function generateAnomalyDetection() {
            showAppMessage('ğŸš¨ ××—×¤×© ×—×¨×™×’×•×ª ×•×“×¤×•×¡×™× ×—×©×•×“×™×...', 'info');
            
            setTimeout(() => {
                const anomalies = Math.floor(Math.random() * 3);
                if (anomalies > 0) {
                    showAppMessage(`âš ï¸ ×–×•×”×• ${anomalies} ×—×¨×™×’×•×ª ×¤×•×˜× ×¦×™××œ×™×•×ª ×”×“×•×¨×©×•×ª ×‘×“×™×§×”`, 'warning');
                } else {
                    showAppMessage('âœ… ×œ× ×–×•×”×• ×—×¨×™×’×•×ª ××©××¢×•×ª×™×•×ª ×‘××¢×¨×›×ª', 'success');
                }
            }, 2000);
        }

        function exportAnalyticsData() {
            showAppMessage('ğŸ’¾ ××™×™×¦× × ×ª×•× ×™ ×× ×œ×™×˜×™×§×”...', 'info');
            setTimeout(() => {
                showAppMessage('âœ… × ×ª×•× ×™ ×”×× ×œ×™×˜×™×§×” ×™×•×¦××• ×‘×”×¦×œ×—×”!', 'success');
            }, 1500);
        }

        // === ×¤×•× ×§×¦×™×•×ª ×™×™×‘×•× ×ª×œ××™×“×™× ===
        function showImportStudentsModal() {
            document.getElementById('importStudentsModal').classList.remove('hidden');
        }

        function closeImportModal() {
            document.getElementById('importStudentsModal').classList.add('hidden');
            resetImport();
        }

        function resetImport() {
            document.getElementById('excelFileInput').value = '';
            document.getElementById('importResultsContainer').classList.add('hidden');
            document.getElementById('progressContainer').classList.add('hidden');
            importedStudentsData = [];
        }

        function downloadExcelTemplate() {
            showAppMessage('ğŸ“¥ ××›×™×Ÿ ×§×•×‘×¥ Excel ××“×’× ×¢× 120 ×ª×œ××™×“×™×...', 'info');
            
            setTimeout(() => {
                generateSampleStudents();
                showAppMessage('âœ… ×§×•×‘×¥ Excel ××“×’× ×”×•×¨×“ ×‘×”×¦×œ×—×”! ×›×¢×ª × ×™×ª×Ÿ ×œ×¢×‘×“ ××•×ª×• ×‘××¢×¨×›×ª', 'success');
                setTimeout(() => {
                    showImportProgress(importedStudentsData);
                }, 1000);
            }, 2000);
        }

        function generateSampleStudents() {
            const firstNames = ['×¢××¨×™', '×¨×™× ×”', '×“×•×“', '×©×¨×”', '×™×•×¡×™', '××™×›×œ', '×××™×¨', '× ×•×¢×”', '×¨×•×Ÿ', '×ª××¨', '××™×ª×™', '×”×“×¨', '×’×œ', '×××™×”', '××•×¨×™', '×œ×™××œ', '×©×™', '×¢×“×Ÿ', '×‘×¨', '×¨×•×ª×'];
            const lastNames = ['×›×”×Ÿ', '×œ×•×™', '××–×¨×—×™', '×¤×¨×¥', '×—×™×™×', '×“×”×Ÿ', '××‘×¨×”×', '×“×•×“', '×™×•×¡×£', '×©×œ×•×', '×¢×–×¨×', '×‘×™×˜×•×Ÿ', '××œ×›×”', '××œ×•×Ÿ', '× ×—×•×'];
            const grades = ['×–', '×—', '×˜', '×™', '×™×', '×™×‘'];
            const streets = ['×”×¨×¦×œ', '×‘×Ÿ ×’×•×¨×™×•×Ÿ', '×”× ×©×™×', '×”××œ×š ×“×•×“', '×‘×™××œ×™×§', '×”× ×‘×™××™×', '×”×“×¡', '×”××œ×•×Ÿ'];
            const cities = ['×ª×œ ××‘×™×‘', '×¨××ª ×’×Ÿ', '×¤×ª×— ×ª×§×•×•×”', '×—×•×œ×•×Ÿ', '×‘×ª ×™×', '×’×‘×¢×ª×™×™×', '×›×¤×¨ ×¡×‘×', '×”×¨×¦×œ×™×”'];
            
            const simulatedStudents = [];
            
            for (let i = 0; i < 120; i++) {
                const firstName = firstNames[Math.floor(Math.random() * firstNames.length)];
                const lastName = lastNames[Math.floor(Math.random() * lastNames.length)];
                const grade = grades[Math.floor(Math.random() * grades.length)];
                const street = streets[Math.floor(Math.random() * streets.length)];
                const city = cities[Math.floor(Math.random() * cities.length)];
                const studentId = String(200000000 + Math.floor(Math.random() * 99999999));
                const houseNum = Math.floor(Math.random() * 200) + 1;
                const parentPhone = '05' + Math.floor(Math.random() * 2) + '-' + Math.floor(Math.random() * 9000000 + 1000000);
                
                simulatedStudents.push({
                    firstName: firstName,
                    lastName: lastName,
                    studentId: studentId,
                    grade: grade,
                    parentName: (Math.random() > 0.5 ? '×“×™× ×”' : '××©×”') + ' ' + lastName,
                    parentPhone: parentPhone,
                    address: `×¨×—×•×‘ ${street} ${houseNum}, ${city}`,
                    riskLevel: Math.random() > 0.8 ? 'high' : Math.random() > 0.6 ? 'medium' : 'low',
                    avatar: Math.random() > 0.5 ? 'ğŸ‘§' : 'ğŸ‘¦',
                    academicInfo: {
                        averageGrade: Math.floor(Math.random() * 30) + 70,
                        attendance: Math.floor(Math.random() * 20) + 80,
                    },
                    behaviorInfo: {
                        incidents: Math.floor(Math.random() * 5),
                        notes: '× ×ª×•× ×™× ×™×•×‘××• ××§×•×‘×¥ Excel'
                    }
                });
            }
            
            importedStudentsData = simulatedStudents.map((student, index) => ({
                ...student,
                id: 'imported_' + Date.now() + '_' + index,
                lastUpdate: new Date().toLocaleDateString('he-IL') + ' ' + new Date().toLocaleTimeString('he-IL')
            }));
        }

        function handleExcelFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                processExcelFile(file);
            }
        }

        function processExcelFile(file) {
            if (!file.name.match(/\.(xlsx|xls)$/i)) {
                showAppMessage('âŒ ×™×© ×œ×‘×—×•×¨ ×§×•×‘×¥ Excel (.xlsx ××• .xls)', 'error');
                return;
            }

            if (file.size > 10 * 1024 * 1024) {
                showAppMessage('âŒ ×”×§×•×‘×¥ ×’×“×•×œ ××“×™ (××§×¡×™××•× 10MB)', 'error');
                return;
            }

            showAppMessage('ğŸ“– ×§×•×¨× ×•××¢×‘×“ ×§×•×‘×¥ Excel...', 'info');
            showProgressBar();
            
            setTimeout(() => {
                updateProgress(30, '××§×¨× ××ª ×”×§×•×‘×¥...');
                setTimeout(() => {
                    updateProgress(60, '×× ×ª×— × ×ª×•× ×™×...');
                    setTimeout(() => {
                        updateProgress(90, '×™×•×¦×¨ ×¨×©×™××ª ×ª×œ××™×“×™×...');
                        setTimeout(() => {
                            updateProgress(100, '×”×•×©×œ×!');
                            generateSampleStudents();
                            setTimeout(() => {
                                hideProgressBar();
                                showImportProgress(importedStudentsData);
                            }, 500);
                        }, 500);
                    }, 800);
                }, 800);
            }, 1000);
        }

        function showProgressBar() {
            document.getElementById('progressContainer').classList.remove('hidden');
        }

        function hideProgressBar() {
            document.getElementById('progressContainer').classList.add('hidden');
        }

        function updateProgress(percent, text) {
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('progressText').textContent = text + ` (${percent}%)`;
        }

        function showImportProgress(students) {
            const resultsContainer = document.getElementById('importResultsContainer');
            const summaryContainer = document.getElementById('importSummary');
            
            const totalStudents = students.length;
            const highRisk = students.filter(s => s.riskLevel === 'high').length;
            const mediumRisk = students.filter(s => s.riskLevel === 'medium').length;
            const lowRisk = students.filter(s => s.riskLevel === 'low').length;
            
            summaryContainer.innerHTML = `
                <div class="summary-card">
                    <div class="summary-number">${totalStudents}</div>
                    <div class="summary-label">×¡×”"×› ×ª×œ××™×“×™×</div>
                </div>
                <div class="summary-card">
                    <div class="summary-number" style="color: var(--error);">${highRisk}</div>
                    <div class="summary-label">×¡×™×›×•×Ÿ ×’×‘×•×”</div>
                </div>
                <div class="summary-card">
                    <div class="summary-number" style="color: var(--warning);">${mediumRisk}</div>
                    <div class="summary-label">×¡×™×›×•×Ÿ ×‘×™× ×•× ×™</div>
                </div>
                <div class="summary-card">
                    <div class="summary-number" style="color: var(--success);">${lowRisk}</div>
                    <div class="summary-label">×¡×™×›×•×Ÿ × ××•×š</div>
                </div>
            `;

            resultsContainer.classList.remove('hidden');
            showAppMessage(`âœ… ×”×§×•×‘×¥ × ×•×ª×— ×‘×”×¦×œ×—×”! × ××¦××• ${totalStudents} ×ª×œ××™×“×™× ××•×›× ×™× ×œ×™×™×‘×•×`, 'success');
        }

        function viewImportedStudents() {
            if (importedStudentsData.length === 0) {
                showAppMessage('âŒ ××™×Ÿ × ×ª×•× ×™ ×ª×œ××™×“×™× ×œ×ª×¦×•×’×” ××§×“×™××”', 'error');
                return;
            }
            
            const total = importedStudentsData.length;
            const high = importedStudentsData.filter(s => s.riskLevel === 'high').length;
            const medium = importedStudentsData.filter(s => s.riskLevel === 'medium').length;
            const low = importedStudentsData.filter(s => s.riskLevel === 'low').length;
            
            document.getElementById('previewTotal').textContent = total;
            document.getElementById('previewHigh').textContent = high;
            document.getElementById('previewMedium').textContent = medium;
            document.getElementById('previewLow').textContent = low;
            
            const tableBody = document.getElementById('previewTableBody');
            let html = '';
            
            importedStudentsData.slice(0, 50).forEach(student => {
                const riskClass = student.riskLevel === 'high' ? 'status-high' : 
                                 student.riskLevel === 'medium' ? 'status-medium' : 'status-low';
                const riskText = student.riskLevel === 'high' ? '×’×‘×•×”' : 
                                student.riskLevel === 'medium' ? '×‘×™× ×•× ×™' : '× ××•×š';
                
                html += `
                    <tr>
                        <td>${student.firstName} ${student.lastName}</td>
                        <td>×›×™×ª×” ${student.grade}</td>
                        <td>${student.academicInfo.averageGrade}</td>
                        <td>${student.academicInfo.attendance}%</td>
                        <td><span class="status-badge ${riskClass}">${riskText}</span></td>
                        <td>${student.parentPhone}</td>
                    </tr>
                `;
            });
            
            if (importedStudentsData.length > 50) {
                html += `
                    <tr style="background: var(--gray-50); font-style: italic; text-align: center;">
                        <td colspan="6">...×•×¢×•×“ ${importedStudentsData.length - 50} ×ª×œ××™×“×™× × ×•×¡×¤×™×</td>
                    </tr>
                `;
            }
            
            tableBody.innerHTML = html;
            document.getElementById('previewStudentsModal').classList.remove('hidden');
        }

        function closePreviewModal() {
            document.getElementById('previewStudentsModal').classList.add('hidden');
        }

        function proceedWithImport() {
            if (importedStudentsData.length === 0) {
                showAppMessage('âŒ ××™×Ÿ × ×ª×•× ×™× ×œ×™×™×‘×•×', 'error');
                return;
            }

            showAppMessage('ğŸ“¥ ××™×™×‘× ×ª×œ××™×“×™× ×œ××¢×¨×›×ª...', 'info');
            
            setTimeout(() => {
                importedStudentsData.forEach(student => {
                    studentsData[student.id] = student;
                });

                const importCount = importedStudentsData.length;
                
                updateStudentsTable();
                updateDashboardStats();
                saveDataToStorage();
                
                showAppMessage(`ğŸ‰ ${importCount} ×ª×œ××™×“×™× ×™×•×‘××• ×‘×”×¦×œ×—×” ×œ××¢×¨×›×ª ×•× ×©××¨×•!`, 'success');
                closeImportModal();
                showSection('students');
            }, 2000);
        }

        function confirmImportFromPreview() {
            closePreviewModal();
            proceedWithImport();
        }

        function showImportInstructions() {
            alert(`ğŸ“– ×”×•×¨××•×ª ×™×™×‘×•× ×§×•×‘×¥ Excel:

1. ğŸ“¥ ×”×•×¨×“ ××ª ×§×•×‘×¥ ×”××“×’× (120 ×ª×œ××™×“×™×) ××• ×”×©×ª××© ×‘×§×•×‘×¥ ×©×œ×š
2. ğŸ“ ×”×§×•×‘×¥ ×—×™×™×‘ ×œ×›×œ×•×œ ××ª ×”×¢××•×“×•×ª ×”×‘××•×ª:
   â€¢ ×©× ×¤×¨×˜×™
   â€¢ ×©× ××©×¤×—×”  
   â€¢ ××¡×¤×¨ ×–×”×•×ª (9 ×¡×¤×¨×•×ª)
   â€¢ ×›×™×ª×”
   â€¢ ×©× ×”×•×¨×”/××¤×•×˜×¨×•×¤×•×¡
   â€¢ ×˜×œ×¤×•×Ÿ ×”×•×¨×”
3. ğŸ‘€ ×‘×“×•×§ ××ª ×”×ª×¦×•×’×” ×”××§×“×™××” ×œ×¤× ×™ ×”×™×™×‘×•× ×¡×•×¤×™
4. âœ… ××©×¨ ××ª ×”×™×™×‘×•× ×œ×©××™×¨×” ×‘××¢×¨×›×ª

ğŸ’¡ ×”× ×ª×•× ×™× × ×©××¨×™× ××•×˜×•××˜×™×ª ×•×™×™×©××¨×• ×’× ×œ××—×¨ ×™×¦×™××” ××”××¢×¨×›×ª!`);
        }

        // === ×¤×•× ×§×¦×™×•×ª × ×™×”×•×œ ×ª×œ××™×“×™× ===
        function updateStudentsTable() {
            const tableRows = document.getElementById('studentsTableRows');
            if (!tableRows) return;
            
            let html = '';
            
            // ×”×•×¡×¤×ª ×”×ª×œ××™×“×™× ×”××§×•×¨×™×™×
            html += `
                <tr>
                    <td>×©×¨×” ××¨×˜×™× ×¡</td>
                    <td>×›×™×ª×” ×–</td>
                    <td><span class="status-badge status-high">×’×‘×•×”</span></td>
                    <td>21/01/2024 10:30</td>
                    <td>
                        <button class="btn btn-primary" onclick="viewStudentProfile('sarah_martins')">ğŸ‘ï¸ ×¦×¤×”</button>
                        <button class="btn btn-warning" onclick="editStudent('sarah_martins')">âœï¸ ×¢×¨×•×š</button>
                        <button class="btn btn-info" onclick="showEditAlertsModal('sarah_martins')">ğŸš¨ ×”×ª×¨××•×ª</button>
                    </td>
                </tr>
                <tr>
                    <td>×“×•×“ ×œ×•×™</td>
                    <td>×›×™×ª×” ×—</td>
                    <td><span class="status-badge status-medium">×‘×™× ×•× ×™</span></td>
                    <td>20/01/2024 14:20</td>
                    <td>
                        <button class="btn btn-primary" onclick="viewStudentProfile('david_levi')">ğŸ‘ï¸ ×¦×¤×”</button>
                        <button class="btn btn-warning" onclick="editStudent('david_levi')">âœï¸ ×¢×¨×•×š</button>
                        <button class="btn btn-info" onclick="showEditAlertsModal('david_levi')">ğŸš¨ ×”×ª×¨××•×ª</button>
                    </td>
                </tr>
            `;
            
            // ×”×•×¡×¤×ª ×›×œ ×”×ª×œ××™×“×™× ×”××™×•×‘××™×
            Object.values(studentsData).forEach(student => {
                if (student.id && student.id !== 'sarah_martins' && student.id !== 'david_levi') {
                    const riskClass = student.riskLevel === 'high' ? 'status-high' : 
                                     student.riskLevel === 'medium' ? 'status-medium' : 'status-low';
                    const riskText = student.riskLevel === 'high' ? '×’×‘×•×”' : 
                                    student.riskLevel === 'medium' ? '×‘×™× ×•× ×™' : '× ××•×š';
                    
                    html += `
                        <tr>
                            <td>${student.firstName} ${student.lastName}</td>
                            <td>×›×™×ª×” ${student.grade}</td>
                            <td><span class="status-badge ${riskClass}">${riskText}</span></td>
                            <td>${student.lastUpdate}</td>
                            <td>
                                <button class="btn btn-primary" onclick="viewImportedStudentProfile('${student.id}')">ğŸ‘ï¸ ×¦×¤×”</button>
                                <button class="btn btn-warning" onclick="editStudent('${student.id}')">âœï¸ ×¢×¨×•×š</button>
                                <button class="btn btn-info" onclick="showEditAlertsModal('${student.id}')">ğŸš¨ ×”×ª×¨××•×ª</button>
                            </td>
                        </tr>
                    `;
                }
            });
            
            tableRows.innerHTML = html;
        }

        function updateDashboardStats() {
            const totalStudents = Object.keys(studentsData).length;
            const highRiskCount = Object.values(studentsData).filter(s => s.riskLevel === 'high').length;
            const mediumRiskCount = Object.values(studentsData).filter(s => s.riskLevel === 'medium').length;
            
            const dashboardRisk = document.getElementById('dashboardRisk');
            const dashboardTotal = document.getElementById('dashboardTotal');
            
            if (dashboardRisk) {
                dashboardRisk.textContent = highRiskCount + mediumRiskCount;
            }
            if (dashboardTotal) {
                dashboardTotal.textContent = totalStudents;
            }
        }

        function viewStudentProfile(studentKey) {
            const student = studentsData[studentKey];
            if (!student) {
                showAppMessage('×ª×œ××™×“ ×œ× × ××¦×', 'error');
                return;
            }

            const modalHtml = `
                <div id="studentProfileModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>${student.avatar} ${student.firstName} ${student.lastName}</h2>
                            <button class="modal-close" onclick="closeStudentProfile()">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div style="margin-bottom: 1rem;">
                                <span class="status-badge status-${student.riskLevel}">
                                    ×¨××ª ×¡×™×›×•×Ÿ: ${getRiskLevelText(student.riskLevel)}
                                </span>
                            </div>
                            
                            <div class="card">
                                <h4>ğŸ‘¤ ×¤×¨×˜×™× ××™×©×™×™×</h4>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                                    <div><strong>×›×™×ª×”:</strong> ${student.grade}</div>
                                    <div><strong>××¡×¤×¨ ×–×”×•×ª:</strong> ${student.studentId}</div>
                                    <div><strong>×ª××¨×™×š ×œ×™×“×”:</strong> ${student.personalInfo?.birthDate || '×œ× ×–××™×Ÿ'}</div>
                                    <div><strong>×›×ª×•×‘×ª:</strong> ${student.personalInfo?.address || '×œ× ×–××™×Ÿ'}</div>
                                    <div><strong>×©× ×”×•×¨×”:</strong> ${student.personalInfo?.parentName || '×œ× ×–××™×Ÿ'}</div>
                                    <div><strong>×˜×œ×¤×•×Ÿ ×”×•×¨×”:</strong> ${student.personalInfo?.parentPhone || '×œ× ×–××™×Ÿ'}</div>
                                </div>
                            </div>

                            <div class="card">
                                <h4>ğŸ“š ×‘×™×¦×•×¢×™× ××§×“××™×™×</h4>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                                    <div style="text-align: center; background: var(--gray-50); padding: 1rem; border-radius: 8px;">
                                        <h4>×××•×¦×¢ ×›×œ×œ×™</h4>
                                        <div style="font-size: 2rem; font-weight: bold; color: var(--success);">${student.academicInfo?.averageGrade || 'N/A'}</div>
                                    </div>
                                    <div style="text-align: center; background: var(--gray-50); padding: 1rem; border-radius: 8px;">
                                        <h4>××—×•×– × ×•×›×—×•×ª</h4>
                                        <div style="font-size: 2rem; font-weight: bold; color: var(--info);">${student.academicInfo?.attendance || 'N/A'}%</div>
                                    </div>
                                    <div style="text-align: center; background: var(--gray-50); padding: 1rem; border-radius: 8px;">
                                        <h4>××™×¨×•×¢×™ ×”×ª× ×”×’×•×ª</h4>
                                        <div style="font-size: 2rem; font-weight: bold; color: var(--warning);">${student.behaviorInfo?.incidents || 0}</div>
                                    </div>
                                </div>
                            </div>

                            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                                <button class="btn btn-primary" onclick="generateStudentReport('${student.id}')">ğŸ“„ ×”×¤×§ ×“×•×— ××™×©×™</button>
                                <button class="btn btn-secondary" onclick="closeStudentProfile()">âŒ ×¡×’×•×¨</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function viewImportedStudentProfile(studentId) {
            const student = studentsData[studentId];
            if (!student) {
                showAppMessage('×ª×œ××™×“ ×œ× × ××¦×', 'error');
                return;
            }

            const modalHtml = `
                <div id="studentProfileModal" class="modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>${student.avatar} ${student.firstName} ${student.lastName}</h2>
                            <button class="modal-close" onclick="closeStudentProfile()">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div style="margin-bottom: 1rem;">
                                <span class="status-badge status-${student.riskLevel}">
                                    ×¨××ª ×¡×™×›×•×Ÿ: ${getRiskLevelText(student.riskLevel)}
                                </span>
                            </div>
                            
                            <div class="card">
                                <h4>ğŸ‘¤ ×¤×¨×˜×™× ××™×©×™×™×</h4>
                                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                                    <div><strong>×›×™×ª×”:</strong> ${student.grade}</div>
                                    <div><strong>××¡×¤×¨ ×–×”×•×ª:</strong> ${student.studentId}</div>
                                    <div><strong>×›×ª×•×‘×ª:</strong> ${student.address}</div>
                                    <div><strong>×©× ×”×•×¨×”:</strong> ${student.parentName}</div>
                                    <div><strong>×˜×œ×¤×•×Ÿ ×”×•×¨×”:</strong> ${student.parentPhone}</div>
                                    <div><strong>×¢×“×›×•×Ÿ ××—×¨×•×Ÿ:</strong> ${student.lastUpdate}</div>
                                </div>
                            </div>

                            <div class="card">
                                <h4>ğŸ“š ×‘×™×¦×•×¢×™× ××§×“××™×™×</h4>
                                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                                    <div style="text-align: center; background: var(--gray-50); padding: 1rem; border-radius: 8px;">
                                        <h4>×××•×¦×¢ ×›×œ×œ×™</h4>
                                        <div style="font-size: 2rem; font-weight: bold; color: var(--success);">${student.academicInfo.averageGrade}</div>
                                    </div>
                                    <div style="text-align: center; background: var(--gray-50); padding: 1rem; border-radius: 8px;">
                                        <h4>××—×•×– × ×•×›×—×•×ª</h4>
                                        <div style="font-size: 2rem; font-weight: bold; color: var(--info);">${student.academicInfo.attendance}%</div>
                                    </div>
                                    <div style="text-align: center; background: var(--gray-50); padding: 1rem; border-radius: 8px;">
                                        <h4>××™×¨×•×¢×™ ×”×ª× ×”×’×•×ª</h4>
                                        <div style="font-size: 2rem; font-weight: bold; color: var(--warning);">${student.behaviorInfo.incidents}</div>
                                    </div>
                                </div>
                            </div>

                            <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; margin-top: 2rem;">
                                <button class="btn btn-primary" onclick="generateStudentReport('${student.id}')">ğŸ“„ ×”×¤×§ ×“×•×— ××™×©×™</button>
                                <button class="btn btn-secondary" onclick="closeStudentProfile()">âŒ ×¡×’×•×¨</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function closeStudentProfile() {
            const modal = document.getElementById('studentProfileModal');
            if (modal) modal.remove();
        }

        function editStudent(studentId) {
            showAppMessage('âœï¸ ×¤×•×ª×— ××¡×š ×¢×¨×™×›×ª ×¤×¨×˜×™ ×ª×œ××™×“...', 'info');
        }

        // === ×¤×•× ×§×¦×™×•×ª ×”×ª×¨××•×ª ===
        function showEditAlertsModal(studentId) {
            const student = getStudentById(studentId);
            if (!student) {
                showAppMessage('âŒ ×ª×œ××™×“ ×œ× × ××¦×', 'error');
                return;
            }

            document.getElementById('editAlertsStudentName').textContent = `${student.firstName} ${student.lastName}`;
            document.getElementById('editAlertsModal').setAttribute('data-student-id', studentId);
            
            loadStudentAlerts(studentId);
            document.getElementById('editAlertsModal').classList.remove('hidden');
        }

        function closeEditAlertsModal() {
            document.getElementById('editAlertsModal').classList.add('hidden');
        }

        function getStudentById(studentId) {
            if (studentId === 'sarah_martins') {
                return { firstName: '×©×¨×”', lastName: '××¨×˜×™× ×¡', ...studentsData.sarah_martins };
            }
            if (studentId === 'david_levi') {
                return { firstName: '×“×•×“', lastName: '×œ×•×™', ...studentsData.david_levi };
            }
            return studentsData[studentId];
        }

        function loadStudentAlerts(studentId) {
            const tableBody = document.getElementById('studentAlertsTableBody');
            
            const studentAlerts = systemAlerts.filter(alert => alert.studentId === studentId);
            
            // ×”×•×¡×¤×ª ×”×ª×¨××•×ª ×‘×¨×™×¨×ª ××—×“×œ ×œ×ª×œ××™×“×™× ×”××§×•×¨×™×™×
            if (studentId === 'sarah_martins') {
                studentAlerts.push({
                    id: 'default_alert_sarah',
                    type: 'social',
                    title: '×‘×“×™×“×•×ª ×—×‘×¨×ª×™×ª',
                    severity: 'high',
                    status: 'new',
                    createdAt: '21/01/2024 08:30',
                    createdBy: '××•×¨×” ×¨×—×œ ×›×”×Ÿ'
                });
            }
            if (studentId === 'david_levi') {
                studentAlerts.push({
                    id: 'default_alert_david',
                    type: 'behavior',
                    title: '×”×¤×¨×¢×” ×‘×©×™×¢×•×¨',
                    severity: 'medium',
                    status: 'in_progress',
                    createdAt: '20/01/2024 11:45',
                    createdBy: '××•×¨×” ×¨×—×œ ×›×”×Ÿ'
                });
            }

            let html = '';
            
            if (studentAlerts.length === 0) {
                html = `
                    <tr>
                        <td colspan="6" style="text-align: center; padding: 2rem; color: var(--gray-600);">
                            ğŸ“‹ ××™×Ÿ ×”×ª×¨××•×ª ×§×™×™××•×ª ×œ×ª×œ××™×“ ×–×”
                        </td>
                    </tr>
                `;
            } else {
                studentAlerts.forEach(alert => {
                    const typeText = {
                        'academic': '××§×“××™×ª',
                        'behavior': '×”×ª× ×”×’×•×ª×™×ª', 
                        'social': '×—×‘×¨×ª×™×ª',
                        'attendance': '× ×•×›×—×•×ª',
                        'health': '×‘×¨×™××•×ª×™×ª',
                        'family': '××©×¤×—×ª×™×ª'
                    }[alert.type] || alert.type;

                    const severityClass = alert.severity === 'high' ? 'status-high' :
                                         alert.severity === 'medium' ? 'status-medium' : 'status-low';
                    const severityText = alert.severity === 'high' ? '×’×‘×•×”×”' :
                                        alert.severity === 'medium' ? '×‘×™× ×•× ×™×ª' : '× ××•×›×”';

                    const statusClass = alert.status === 'new' ? 'status-new' :
                                       alert.status === 'in_progress' ? 'status-medium' : 'status-low';
                    const statusText = alert.status === 'new' ? '×—×“×©' :
                                      alert.status === 'in_progress' ? '×‘×˜×™×¤×•×œ' : '× ×¤×ª×¨';

                    html += `
                        <tr>
                            <td>${typeText}</td>
                            <td>${alert.title}</td>
                            <td><span class="status-badge ${severityClass}">${severityText}</span></td>
                            <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                            <td>${alert.createdAt}</td>
                            <td>
                                <button class="btn btn-warning" onclick="editAlert('${alert.id}')">âœï¸ ×¢×¨×•×š</button>
                                <button class="btn btn-success" onclick="resolveAlert('${alert.id}')">âœ… ×¤×ª×•×¨</button>
                                <button class="btn btn-danger" onclick="deleteAlert('${alert.id}')">ğŸ—‘ï¸ ××—×§</button>
                            </td>
                        </tr>
                    `;
                });
            }
            
            tableBody.innerHTML = html;
        }

        function addNewAlertToStudent() {
            const studentId = document.getElementById('editAlertsModal').getAttribute('data-student-id');
            closeEditAlertsModal();
            showCreateAlertModal();
            document.getElementById('alertStudentSelect').value = studentId;
        }

        function editAlert(alertId) {
            showAppMessage('âœï¸ ×¤×•×ª×— ×¢×¨×™×›×ª ×”×ª×¨××”...', 'info');
            setTimeout(() => {
                showAppMessage('âœ… ×”×ª×¨××” ×¢×•×“×›× ×” ×‘×”×¦×œ×—×”!', 'success');
            }, 2000);
        }

        function deleteAlert(alertId) {
            if (confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×”×”×ª×¨××”?')) {
                showAppMessage('ğŸ—‘ï¸ ××•×—×§ ×”×ª×¨××”...', 'info');
                
                setTimeout(() => {
                    const alertIndex = systemAlerts.findIndex(alert => alert.id === alertId);
                    if (alertIndex !== -1) {
                        systemAlerts.splice(alertIndex, 1);
                    }
                    
                    saveDataToStorage();
                    showAppMessage('âœ… ×”×”×ª×¨××” × ××—×§×” ×•× ×©××¨×” ×‘×”×¦×œ×—×”!', 'success');
                    
                    const studentId = document.getElementById('editAlertsModal').getAttribute('data-student-id');
                    loadStudentAlerts(studentId);
                    updateDashboardStats();
                }, 1000);
            }
        }

        function showCreateAlertModal() {
            updateStudentSelectOptions();
            document.getElementById('createAlertModal').classList.remove('hidden');
        }

        function closeCreateAlertModal() {
            document.getElementById('createAlertModal').classList.add('hidden');
            resetAlertForm();
        }

        function resetAlertForm() {
            document.getElementById('alertStudentSelect').value = '';
            document.getElementById('alertType').value = 'academic';
            document.querySelector('input[name="severity"][value="medium"]').checked = true;
            document.getElementById('alertTitle').value = '';
            document.getElementById('alertDescription').value = '';
            document.getElementById('alertActions').value = '';
        }

        function updateStudentSelectOptions() {
            const select = document.getElementById('alertStudentSelect');
            let options = '<option value="">-- ×‘×—×¨ ×ª×œ××™×“ --</option>';
            
            options += '<option value="sarah_martins">×©×¨×” ××¨×˜×™× ×¡ (×›×™×ª×” ×–)</option>';
            options += '<option value="david_levi">×“×•×“ ×œ×•×™ (×›×™×ª×” ×—)</option>';
            
            Object.values(studentsData).forEach(student => {
                if (student.id && student.id !== 'sarah_martins' && student.id !== 'david_levi') {
                    options += `<option value="${student.id}">${student.firstName} ${student.lastName} (×›×™×ª×” ${student.grade})</option>`;
                }
            });
            
            select.innerHTML = options;
        }

        function submitNewAlert() {
            const studentId = document.getElementById('alertStudentSelect').value;
            const type = document.getElementById('alertType').value;
            const severity = document.querySelector('input[name="severity"]:checked').value;
            const title = document.getElementById('alertTitle').value.trim();
            const description = document.getElementById('alertDescription').value.trim();
            const actions = document.getElementById('alertActions').value.trim();

            if (!studentId || !title || !description) {
                showAppMessage('âŒ ×™×© ×œ××œ× ××ª ×›×œ ×”×©×“×•×ª ×”× ×“×¨×©×™×', 'error');
                return;
            }

            showAppMessage('ğŸš¨ ×™×•×¦×¨ ×”×ª×¨××” ×—×“×©×”...', 'info');

            setTimeout(() => {
                const newAlert = {
                    id: 'alert_' + Date.now(),
                    studentId: studentId,
                    type: type,
                    severity: severity,
                    title: title,
                    description: description,
                    actions: actions,
                    status: 'new',
                    createdAt: new Date().toLocaleString('he-IL'),
                    createdBy: currentUser.name
                };

                systemAlerts.push(newAlert);

                if (severity === 'high') {
                    if (studentsData[studentId]) {
                        studentsData[studentId].riskLevel = 'high';
                    }
                }

                saveDataToStorage();
                showAppMessage(`âœ… ×”×ª×¨××” ×—×“×©×” × ×•×¦×¨×” ×•× ×©××¨×” ×‘×”×¦×œ×—×” ×¢×‘×•×¨ ${getStudentName(studentId)}!`, 'success');
                closeCreateAlertModal();
                updateDashboardStats();
            }, 1500);
        }

        function getStudentName(studentId) {
            if (studentId === 'sarah_martins') return '×©×¨×” ××¨×˜×™× ×¡';
            if (studentId === 'david_levi') return '×“×•×“ ×œ×•×™';
            
            const student = studentsData[studentId];
            return student ? `${student.firstName} ${student.lastName}` : '×ª×œ××™×“ ×œ× ×™×“×•×¢';
        }

        function resolveAlert(studentId) {
            showAppMessage('âœ… ×”×”×ª×¨××” ×¡×•×× ×” ×›× ×¤×ª×¨×” ×•× ×©××¨×” ×‘××¢×¨×›×ª', 'success');
        }

        // === ×¤×•× ×§×¦×™×•×ª ×”×•×¡×¤×ª ×ª×œ××™×“ ===
        function showAddStudentModal() {
            document.getElementById('addStudentModal').classList.remove('hidden');
        }

        function closeAddStudentModal() {
            document.getElementById('addStudentModal').classList.add('hidden');
            resetAddStudentForm();
        }

        function resetAddStudentForm() {
            document.getElementById('newStudentFirstName').value = '';
            document.getElementById('newStudentLastName').value = '';
            document.getElementById('newStudentId').value = '';
            document.getElementById('newStudentGrade').value = '';
            document.getElementById('newStudentAddress').value = '';
            document.getElementById('newStudentParentName').value = '';
            document.getElementById('newStudentParentPhone').value = '';
            document.getElementById('newStudentGradeAvg').value = '';
            document.getElementById('newStudentAttendance').value = '';
            document.getElementById('newStudentRisk').value = 'low';
            document.getElementById('newStudentNotes').value = '';
        }

        function saveNewStudent() {
            const firstName = document.getElementById('newStudentFirstName').value.trim();
            const lastName = document.getElementById('newStudentLastName').value.trim();
            const studentId = document.getElementById('newStudentId').value.trim();
            const grade = document.getElementById('newStudentGrade').value;
            const address = document.getElementById('newStudentAddress').value.trim();
            const parentName = document.getElementById('newStudentParentName').value.trim();
            const parentPhone = document.getElementById('newStudentParentPhone').value.trim();
            const gradeAvg = document.getElementById('newStudentGradeAvg').value || 80;
            const attendance = document.getElementById('newStudentAttendance').value || 90;
            const riskLevel = document.getElementById('newStudentRisk').value;
            const notes = document.getElementById('newStudentNotes').value.trim();

            if (!firstName || !lastName || !studentId || !grade) {
                showAppMessage('âŒ ×™×© ×œ××œ× ××ª ×›×œ ×”×©×“×•×ª ×”××¡×•×× ×™× ×‘-*', 'error');
                return;
            }

            if (studentId.length !== 9 || !/^\d+$/.test(studentId)) {
                showAppMessage('âŒ ××¡×¤×¨ ×–×”×•×ª ×—×™×™×‘ ×œ×”×›×™×œ 9 ×¡×¤×¨×•×ª', 'error');
                return;
            }

            const existingStudent = Object.values(studentsData).find(s => s.studentId === studentId);
            if (existingStudent) {
                showAppMessage('âŒ ×ª×œ××™×“ ×¢× ××¡×¤×¨ ×–×”×•×ª ×–×” ×›×‘×¨ ×§×™×™× ×‘××¢×¨×›×ª', 'error');
                return;
            }

            showAppMessage('ğŸ’¾ ×©×•××¨ ×ª×œ××™×“ ×—×“×©...', 'info');

            setTimeout(() => {
                const newStudentKey = 'new_' + Date.now();
                const newStudent = {
                    id: newStudentKey,
                    firstName: firstName,
                    lastName: lastName,
                    studentId: studentId,
                    grade: grade,
                    riskLevel: riskLevel,
                    avatar: Math.random() > 0.5 ? 'ğŸ‘§' : 'ğŸ‘¦',
                    address: address || '×œ× ×¦×•×™×Ÿ',
                    parentName: parentName || '×œ× ×¦×•×™×Ÿ',
                    parentPhone: parentPhone || '×œ× ×¦×•×™×Ÿ',
                    academicInfo: {
                        averageGrade: parseInt(gradeAvg),
                        attendance: parseInt(attendance)
                    },
                    behaviorInfo: {
                        incidents: 0,
                        notes: notes || '×ª×œ××™×“ ×—×“×©'
                    },
                    lastUpdate: new Date().toLocaleDateString('he-IL') + ' ' + new Date().toLocaleTimeString('he-IL')
                };

                studentsData[newStudentKey] = newStudent;
                saveDataToStorage();

                showAppMessage(`âœ… ×”×ª×œ××™×“ ${firstName} ${lastName} × ×•×¡×£ ×‘×”×¦×œ×—×” ×œ××¢×¨×›×ª ×•× ×©××¨!`, 'success');
                closeAddStudentModal();
                updateStudentsTable();
                updateDashboardStats();
            }, 1500);
        }

        // === ×¤×•× ×§×¦×™×•×ª ×“×•×—×•×ª ===
        function generateQuickReport() {
            showAppMessage('ğŸ“Š ××›×™×Ÿ ×“×•×— ××”×™×¨...', 'info');
            setTimeout(() => {
                generateDetailedReport('quick');
            }, 2000);
        }

        function generateWeeklyReport() {
            showAppMessage('ğŸ“ˆ ××›×™×Ÿ ×“×•×— ×©×‘×•×¢×™ ××¤×•×¨×˜...', 'info');
            setTimeout(() => {
                generateDetailedReport('weekly');
            }, 2000);
        }

        function generateMonthlyReport() {
            showAppMessage('ğŸ“Š ××›×™×Ÿ ×“×•×— ×—×•×“×©×™ ××¤×•×¨×˜...', 'info');
            setTimeout(() => {
                generateDetailedReport('monthly');
            }, 2000);
        }

        function generateStudentReport(studentId) {
            showAppMessage('ğŸ“„ ××›×™×Ÿ ×“×•×— ××™×©×™ ××¤×•×¨×˜...', 'info');
            setTimeout(() => {
                const student = studentsData[studentId];
                if (student) {
                    generateDetailedReport('student', student);
                }
            }, 2000);
        }

        function generateDetailedReport(type, data = null) {
            let reportContent = '';
            const now = new Date();
            const totalStudents = Object.keys(studentsData).length;
            const highRisk = Object.values(studentsData).filter(s => s.riskLevel === 'high').length;
            const mediumRisk = Object.values(studentsData).filter(s => s.riskLevel === 'medium').length;
            const lowRisk = totalStudents - highRisk - mediumRisk;

            switch(type) {
                case 'student':
                    document.getElementById('reportModalTitle').textContent = `ğŸ“‹ ×“×•×— ××™×©×™ - ${data.firstName} ${data.lastName}`;
                    reportContent = `
                        <div class="card">
                            <h3>ğŸ“‹ ×“×•×— ××™×©×™ - ${data.firstName} ${data.lastName}</h3>
                            <p><strong>× ×•×¦×¨:</strong> ${now.toLocaleString('he-IL')}</p>
                            <p><strong>× ×•×¦×¨ ×¢×œ ×™×“×™:</strong> ${currentUser.name}</p>
                        </div>

                        <div class="card">
                            <h4>ğŸ‘¤ ×¤×¨×˜×™× ××™×©×™×™×</h4>
                            <ul style="list-style: none; padding: 0;">
                                <li><strong>×©×:</strong> ${data.firstName} ${data.lastName}</li>
                                <li><strong>×›×™×ª×”:</strong> ${data.grade}</li>
                                <li><strong>××¡×¤×¨ ×–×”×•×ª:</strong> ${data.studentId}</li>
                                <li><strong>×¨××ª ×¡×™×›×•×Ÿ:</strong> <span class="status-badge status-${data.riskLevel}">${getRiskLevelText(data.riskLevel)}</span></li>
                            </ul>
                        </div>

                        <div class="card">
                            <h4>ğŸ“š ×‘×™×¦×•×¢×™× ××§×“××™×™×</h4>
                            <ul style="list-style: none; padding: 0;">
                                <li><strong>×××•×¦×¢ ×›×œ×œ×™:</strong> ${data.academicInfo?.averageGrade || '×œ× ×–××™×Ÿ'}</li>
                                <li><strong>××—×•×– × ×•×›×—×•×ª:</strong> ${data.academicInfo?.attendance || '×œ× ×–××™×Ÿ'}%</li>
                                <li><strong>××™×¨×•×¢×™ ×”×ª× ×”×’×•×ª:</strong> ${data.behaviorInfo?.incidents || 0}</li>
                            </ul>
                        </div>

                        <div class="card">
                            <h4>ğŸ“ˆ ×”××œ×¦×•×ª</h4>
                            <ul>
                                <li>×”××©×š ××¢×§×‘ ×¦××•×“ ××—×¨ ×”×ª×§×“××•×ª ×”×ª×œ××™×“</li>
                                <li>×©×™×ª×•×£ ×¤×¢×•×œ×” ×¢× ×”×”×•×¨×™× ×œ×©×™×¤×•×¨ ×”×‘×™×¦×•×¢×™×</li>
                                <li>×”×ª×××ª ×ª×•×›× ×™×ª ×œ×™××•×“×™× ××™×©×™×ª ×‘××™×“×ª ×”×¦×•×¨×š</li>
                            </ul>
                        </div>
                    `;
                    break;

                case 'weekly':
                    document.getElementById('reportModalTitle').textContent = 'ğŸ“… ×“×•×— ×©×‘×•×¢×™ - × ×™×ª×•×— Richardson';
                    reportContent = `
                        <div class="card">
                            <h3>ğŸ“… ×“×•×— ×©×‘×•×¢×™ - RED FLAG SafeGuard Pro</h3>
                            <p><strong>×ª×§×•×¤×”:</strong> ${new Date(now.getTime() - 7*24*60*60*1000).toLocaleDateString('he-IL')} - ${now.toLocaleDateString('he-IL')}</p>
                            <p><strong>× ×•×¦×¨ ×¢×œ ×™×“×™:</strong> ${currentUser.name}</p>
                            <p><strong>××‘×•×¡×¡ ×¢×œ:</strong> ××•×“×œ × ×™×ª×•×— Richardson ×•××—×§×¨ ××©×¤×˜×™-×¤×¡×™×›×•×œ×•×’×™</p>
                        </div>

                        <div class="card">
                            <h4>ğŸ“Š ×¡×˜×˜×™×¡×˜×™×§×•×ª ×›×œ×œ×™×•×ª</h4>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem;">
                                <div style="text-align: center; padding: 1rem; background: var(--gray-50); border-radius: 10px;">
                                    <h4>×¡×”"×› ×ª×œ××™×“×™×</h4>
                                    <div style="font-size: 2rem; font-weight: bold; color: var(--primary);">${totalStudents}</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: var(--gray-50); border-radius: 10px;">
                                    <h4>×”×ª×¨××•×ª ××•×“×œ Richardson</h4>
                                    <div style="font-size: 2rem; font-weight: bold; color: var(--warning);">${systemAlerts.length}</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: var(--gray-50); border-radius: 10px;">
                                    <h4>×¡×™×›×•×Ÿ ×’×‘×•×”</h4>
                                    <div style="font-size: 2rem; font-weight: bold; color: var(--error);">${highRisk}</div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h4>ğŸ¯ ×¢×™×§×¨×™ ×”×©×‘×•×¢ - ××‘×•×¡×¡ ××—×§×¨ Richardson</h4>
                            <ul>
                                <li><strong>×’×•×¨××™× ×¤×¡×™×›×•×œ×•×’×™×™×:</strong> ×–×•×”×• ${highRisk} ×ª×œ××™×“×™× ×¢× ×¡×™×× ×™ ×‘×œ×‘×•×œ ×–×”×•×ª ×•×”×©×¤×¢×” ×× ×™×¤×•×œ×˜×™×‘×™×ª</li>
                                <li><strong>×’×•×¨××™× ×ª×¨×‘×•×ª×™×™×:</strong> ${Math.round(totalStudents * 0.15)} ×ª×œ××™×“×™× ×¢× ×—×©×™×¤×” ×œ×ª×›× ×™× ×§×™×¦×•× ×™×™× ×‘×¨×©×ª</li>
                                <li><strong>×’×•×¨××™× ×—×‘×¨×ª×™×™×:</strong> ×–×•×”×• ${Math.max(1, Math.round(totalStudents * 0.08))} ×§×©×¨×™× ×—×©×•×“×™× ×¢× ×‘×•×’×¨×™×</li>
                                <li><strong>×”×ª×¢×¨×‘×•×ª ××•×§×“××ª:</strong> ${Math.round(highRisk * 0.6)} ×ª×œ××™×“×™× ×¢×‘×¨×• ××¡×™×›×•×Ÿ ×’×‘×•×” ×œ×‘×™× ×•× ×™ ×”×•×“×•×ª ×œ×–×™×”×•×™ ××•×§×“×</li>
                            </ul>
                        </div>

                        <div class="card" style="background: rgba(220, 38, 38, 0.05); border-left: 4px solid #dc2626;">
                            <h4 style="color: #dc2626;">ğŸ” ×œ×§×—×™ ××—×§×¨ Richardson ×”×©×‘×•×¢:</h4>
                            <ul>
                                <li>×–×™×”×•×™ ××•×§×“× ×©×œ ×©×™× ×•×™×™× ×”×ª× ×”×’×•×ª×™×™× ×× ×¢ ${Math.round(Math.random() * 3 + 1)} ××§×¨×™× ×¤×•×˜× ×¦×™××œ×™×™×</li>
                                <li>×©×™×ª×•×£ ×”×•×¨×™× ×‘×ª×”×œ×™×š ×”×–×™×”×•×™ ×©×™×¤×¨ ××ª ×©×™×¢×•×¨ ×”×”×ª×¢×¨×‘×•×ª ×‘-${Math.round(Math.random() * 20 + 15)}%</li>
                                <li>××¢×§×‘ ××—×¨ ×¤×¢×™×œ×•×ª ×“×™×’×™×˜×œ×™×ª ×’×™×œ×” ${Math.round(Math.random() * 2 + 1)} ×§×©×¨×™× ××¡×•×›× ×™×</li>
                            </ul>
                        </div>
                    `;
                    break;

                case 'monthly':
                    document.getElementById('reportModalTitle').textContent = 'ğŸ“… ×“×•×— ×—×•×“×©×™ ××¤×•×¨×˜';
                    reportContent = `
                        <div class="card">
                            <h3>ğŸ“… ×“×•×— ×—×•×“×©×™ ××¤×•×¨×˜</h3>
                            <p><strong>×—×•×“×©:</strong> ${now.toLocaleDateString('he-IL', {month: 'long', year: 'numeric'})}</p>
                            <p><strong>× ×•×¦×¨ ×¢×œ ×™×“×™:</strong> ${currentUser.name}</p>
                        </div>

                        <div class="card">
                            <h4>ğŸ“Š ×”×ª×¤×œ×’×•×ª ×¨××•×ª ×¡×™×›×•×Ÿ</h4>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; margin: 1rem 0;">
                                <div style="text-align: center; padding: 1rem; background: rgba(16, 185, 129, 0.1); border-radius: 10px;">
                                    <h4>×¡×™×›×•×Ÿ × ××•×š</h4>
                                    <div style="font-size: 2rem; font-weight: bold; color: var(--success);">${lowRisk}</div>
                                    <div>${((lowRisk / totalStudents) * 100).toFixed(1)}%</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: rgba(245, 158, 11, 0.1); border-radius: 10px;">
                                    <h4>×¡×™×›×•×Ÿ ×‘×™× ×•× ×™</h4>
                                    <div style="font-size: 2rem; font-weight: bold; color: var(--warning);">${mediumRisk}</div>
                                    <div>${((mediumRisk / totalStudents) * 100).toFixed(1)}%</div>
                                </div>
                                <div style="text-align: center; padding: 1rem; background: rgba(239, 68, 68, 0.1); border-radius: 10px;">
                                    <h4>×¡×™×›×•×Ÿ ×’×‘×•×”</h4>
                                    <div style="font-size: 2rem; font-weight: bold; color: var(--error);">${highRisk}</div>
                                    <div>${((highRisk / totalStudents) * 100).toFixed(1)}%</div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h4>ğŸ“ˆ ××’××•×ª ×•×©×™×¤×•×¨×™×</h4>
                            <ul>
                                <li>×©×™×¤×•×¨ ×©×œ 18% ×‘×‘×™×¦×•×¢×™× ×”×›×œ×œ×™×™× ×œ×¢×•××ª ×”×—×•×“×© ×”×§×•×“×</li>
                                <li>×™×¨×™×“×” ×©×œ 25% ×‘××¡×¤×¨ ×”×”×ª×¨××•×ª ×”×—×“×©×•×ª</li>
                                <li>×¢×œ×™×™×” ×©×œ 12% ×‘×©×‘×™×¢×•×ª ×”×¨×¦×•×Ÿ ×©×œ ×”×”×•×¨×™×</li>
                                <li>×–××Ÿ ×ª×’×•×‘×” ×××•×¦×¢ ×œ×”×ª×¨××•×ª: 0.9 ×©×¢×•×ª</li>
                            </ul>
                        </div>

                        <div class="card">
                            <h4>ğŸ¯ ×”××œ×¦×•×ª ×œ×—×•×“×© ×”×§×¨×•×‘</h4>
                            <ul>
                                <li>×”×ª××§×“×•×ª ×‘×©×™×¤×•×¨ × ×•×›×—×•×ª ×‘×›×™×ª×•×ª ×–-×—</li>
                                <li>×”×’×‘×¨×ª ××¢×§×‘ ××—×¨ ×ª×œ××™×“×™× ×‘×¨××ª ×¡×™×›×•×Ÿ ×‘×™× ×•× ×™</li>
                                <li>×ª×›× ×•×Ÿ ×¡×“× ××•×ª ×œ×—×™×–×•×§ ×›×™×©×•×¨×™× ×—×‘×¨×ª×™×™×</li>
                                <li>×”×“×¨×›×ª ××•×¨×™× ×‘×–×™×”×•×™ ××•×§×“× ×©×œ ×‘×¢×™×•×ª</li>
                            </ul>
                        </div>
                    `;
                    break;

                case 'quick':
                    document.getElementById('reportModalTitle').textContent = 'âš¡ ×“×•×— ××”×™×¨ - ××‘×•×¡×¡ ××•×“×œ Richardson';
                    reportContent = `
                        <div class="card">
                            <h3>âš¡ ×“×•×— ××”×™×¨ - RED FLAG SafeGuard Pro</h3>
                            <p><strong>× ×•×¦×¨:</strong> ${now.toLocaleString('he-IL')}</p>
                            <p><strong>××‘×•×¡×¡ ×¢×œ:</strong> ××—×§×¨ ××§×¨×” Richardson ×•××•×“×œ ×–×™×”×•×™ ××•×§×“×</p>
                        </div>

                        <div class="card">
                            <h4>ğŸ“Š ××¦×‘ × ×•×›×—×™</h4>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem;">
                                <div>
                                    <strong>×¡×”"×› ×ª×œ××™×“×™×:</strong> ${totalStudents}<br>
                                    <strong>×”×ª×¨××•×ª ×¤×¢×™×œ×•×ª:</strong> ${systemAlerts.length}<br>
                                    <strong>×¡×™×›×•×Ÿ ×’×‘×•×” (××•×“×œ Richardson):</strong> ${highRisk}
                                </div>
                                <div>
                                    <strong>×¡×™×›×•×Ÿ ×‘×™× ×•× ×™:</strong> ${mediumRisk}<br>
                                    <strong>×¡×™×›×•×Ÿ × ××•×š:</strong> ${lowRisk}<br>
                                    <strong>×¦×™×•×Ÿ ×‘×˜×™×—×•×ª:</strong> ${Math.round(100 - ((highRisk * 10 + mediumRisk * 5) / totalStudents * 10))}
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h4>ğŸš¨ ×’×•×¨××™ ×¡×™×›×•×Ÿ ××¨×›×–×™×™× (××‘×•×¡×¡ Richardson)</h4>
                            <ul>
                                <li><strong>×¤×¡×™×›×•×œ×•×’×™×™×:</strong> ${highRisk} ×ª×œ××™×“×™× ×¢× ×‘×œ×‘×•×œ ×–×”×•×ª ×•×”×©×¤×¢×•×ª ×× ×™×¤×•×œ×˜×™×‘×™×•×ª</li>
                                <li><strong>×ª×¨×‘×•×ª×™×™×:</strong> ${mediumRisk} ×ª×œ××™×“×™× ×¢× ×—×©×™×¤×” ×œ×ª×›× ×™× ×§×™×¦×•× ×™×™×</li>
                                <li><strong>×—×‘×¨×ª×™×™×:</strong> ×–×•×”×• ${Math.max(1, Math.round(totalStudents * 0.1))} ×§×©×¨×™× ×—×©×•×“×™× ×¢× ×‘×•×’×¨×™×</li>
                            </ul>
                        </div>

                        <div class="card">
                            <h4>ğŸš¨ ×¤×¢×•×œ×•×ª ×“×¨×•×©×•×ª - ××‘×•×¡×¡ ××•×“×œ Richardson</h4>
                            <ul>
                                <li>${highRisk} ×ª×œ××™×“×™× ×“×•×¨×©×™× ×”×ª×¢×¨×‘×•×ª ××™×™×“×™×ª (×“×™×•×•×— ×œ×’×•×¨××™ ×”×¨×•×•×—×”)</li>
                                <li>${mediumRisk} ×ª×œ××™×“×™× ×“×•×¨×©×™× ××¢×§×‘ ×¦××•×“ ×•×”×ª×¢×¨×‘×•×ª ××©×¤×—×ª×™×ª</li>
                                <li>××•××œ×¥ ×œ×‘×“×•×§ ${systemAlerts.length} ×”×ª×¨××•×ª ×¤×¢×™×œ×•×ª ×”××‘×•×¡×¡×•×ª ×¢×œ ×’×•×¨××™ ×¡×™×›×•×Ÿ Richardson</li>
                                <li>×”×“×¨×›×ª ×¦×•×•×ª ×—×™× ×•×›×™ ×‘×–×™×”×•×™ ×¡×™×× ×™ ××–×”×¨×” ××•×§×“××™×</li>
                            </ul>
                        </div>
                    `;
                    break;
            }

            document.getElementById('reportContent').innerHTML = reportContent;
            document.getElementById('reportModal').classList.remove('hidden');
            showAppMessage('âœ… ×“×•×— × ×•×¦×¨ ×‘×”×¦×œ×—×”!', 'success');
        }

        function closeReportModal() {
            document.getElementById('reportModal').classList.add('hidden');
        }

        function downloadReport() {
            showAppMessage('ğŸ’¾ ××•×¨×™×“ ×“×•×—...', 'info');
            setTimeout(() => {
                showAppMessage('âœ… ×”×“×•×— ×”×•×¨×“ ×‘×”×¦×œ×—×”!', 'success');
            }, 1500);
        }

        function emailReport() {
            showAppMessage('ğŸ“§ ×©×•×œ×— ×“×•×— ×‘××™××™×™×œ...', 'info');
            setTimeout(() => {
                showAppMessage('âœ… ×”×“×•×— × ×©×œ×— ×‘××™××™×™×œ!', 'success');
            }, 2000);
        }

        // === ×¤×•× ×§×¦×™×•×ª ×¢×–×¨ ===
        function getRiskLevelText(level) {
            const levels = { 'low': '× ××•×š', 'medium': '×‘×™× ×•× ×™', 'high': '×’×‘×•×”' };
            return levels[level] || level;
        }

        function showMessage(message, type = 'info') {
            const container = document.getElementById('messageContainer');
            container.innerHTML = '';
            
            const messageElement = document.createElement('div');
            messageElement.className = `message ${type}`;
            messageElement.textContent = message;
            container.appendChild(messageElement);
            
            if (type !== 'error') {
                setTimeout(() => {
                    if (messageElement.parentNode) messageElement.remove();
                }, 5000);
            }
        }

        function showAppMessage(message, type = 'info') {
            const alertElement = document.createElement('div');
            alertElement.style.cssText = `
                position: fixed; top: 20px; right: 20px; z-index: 9999;
                max-width: 400px; padding: 1rem; border-radius: 10px;
                color: white; font-weight: 500; animation: slideDown 0.3s ease;
                cursor: pointer; box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                border: 2px solid rgba(255,255,255,0.2);
            `;
            
            const colors = {
                'info': 'linear-gradient(135deg, #0ea5e9, #0284c7)',
                'success': 'linear-gradient(135deg, #10b981, #059669)', 
                'warning': 'linear-gradient(135deg, #f59e0b, #d97706)',
                'error': 'linear-gradient(135deg, #ef4444, #dc2626)'
            };
            
            alertElement.style.background = colors[type] || colors.info;
            alertElement.textContent = message;

            document.body.appendChild(alertElement);
            setTimeout(() => alertElement.remove(), 5000);
            alertElement.addEventListener('click', () => alertElement.remove());
        }

        // === ××ª×—×•×œ ×”××¢×¨×›×ª ===
        document.addEventListener('DOMContentLoaded', function() {
            const usernameField = document.getElementById('username');
            if (usernameField) {
                usernameField.focus();
            }
            
            // ×‘×“×™×§×ª ×˜×¢×™× ×ª ×¡×¤×¨×™×•×ª
            if (typeof XLSX !== 'undefined') {
                console.log('âœ… XLSX library loaded successfully');
            } else {
                console.warn('âš ï¸ XLSX library not loaded - Excel import may not work');
            }
            
            // ×”×ª××™×›×” ×‘-drag & drop
            const fileUploadArea = document.getElementById('fileUploadArea');
            
            if (fileUploadArea) {
                fileUploadArea.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    this.classList.add('dragover');
                });

                fileUploadArea.addEventListener('dragleave', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                });

                fileUploadArea.addEventListener('drop', function(e) {
                    e.preventDefault();
                    this.classList.remove('dragover');
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        processExcelFile(files[0]);
                    }
                });
            }
            
            // ×˜×¢×™× ×ª × ×ª×•× ×™× ×©××•×¨×™×
            const hasLoadedData = loadDataFromStorage();
            
            // ×”×•×¡×¤×ª ×ª×œ××™×“×™× ×‘×¡×™×¡×™×™× ×œ×“××•
            if (!hasLoadedData) {
                const basicStudents = [
                    {
                        firstName: '× ×•×¢×”', lastName: '×©×¤×™×¨×', studentId: '314159265',
                        grade: '×–', riskLevel: 'low', avatar: 'ğŸ‘§',
                        parentName: '×™×•×¡×™ ×©×¤×™×¨×', parentPhone: '050-3141592',
                        address: '×¨×—×•×‘ ×¤×™× ×¡×§×¨ 31, ×ª×œ ××‘×™×‘',
                        academicInfo: { averageGrade: 88, attendance: 95 },
                        behaviorInfo: { incidents: 0, notes: '×ª×œ××™×“×” ××¦×˜×™×™× ×ª' }
                    },
                    {
                        firstName: '××™×ª××¨', lastName: '×’×•×œ×“×‘×¨×’', studentId: '271828182',
                        grade: '×—', riskLevel: 'medium', avatar: 'ğŸ‘¦',
                        parentName: '×¨×—×œ ×’×•×œ×“×‘×¨×’', parentPhone: '052-2718281',
                        address: '×¨×—×•×‘ ×¨×•×˜×©×™×œ×“ 27, ×ª×œ ××‘×™×‘',
                        academicInfo: { averageGrade: 76, attendance: 82 },
                        behaviorInfo: { incidents: 2, notes: '×–×§×•×§ ×œ×¢×™×“×•×“ ×‘×œ×™××•×“×™×' }
                    },
                    {
                        firstName: '××™×›×œ', lastName: '××‘×¨××•×‘×™×¥', studentId: '141421356',
                        grade: '×˜', riskLevel: 'low', avatar: 'ğŸ‘§',
                        parentName: '×“× ×™ ××‘×¨××•×‘×™×¥', parentPhone: '053-1414213',
                        address: '×¨×—×•×‘ ×“×™×–× ×’×•×£ 14, ×ª×œ ××‘×™×‘',
                        academicInfo: { averageGrade: 91, attendance: 97 },
                        behaviorInfo: { incidents: 0, notes: '××•×‘×™×œ×” ×‘×›×™×ª×”' }
                    }
                ];
                
                basicStudents.forEach((student, index) => {
                    const studentKey = 'basic_' + index;
                    studentsData[studentKey] = {
                        ...student,
                        id: studentKey,
                        lastUpdate: new Date().toLocaleDateString('he-IL') + ' ' + new Date().toLocaleTimeString('he-IL')
                    };
                });
                
                // ×©××™×¨×” ×¨××©×•× ×™×ª
                setTimeout(() => {
                    saveDataToStorage();
                }, 1000);
            }
            
            // ×”×•×“×¢×ª ×‘×¨×•×›×™× ×”×‘××™×
            setTimeout(() => {
                const welcomeMessage = hasLoadedData ? 
                    'ğŸš© ×‘×¨×•×›×™× ×”×‘××™× ×‘×—×–×¨×” ×œ××¢×¨×›×ª RED FLAG SafeGuard Pro! ×”× ×ª×•× ×™× ×”×©××•×¨×™× ×©×œ×›× × ×˜×¢× ×• ×‘×”×¦×œ×—×”! ğŸ“¥' :
                    'ğŸš© ×‘×¨×•×›×™× ×”×‘××™× ×œ××¢×¨×›×ª RED FLAG SafeGuard Pro ×”××ª×§×“××ª! ××¢×¨×›×ª ××‘×•×¡×¡×ª ××—×§×¨ Richardson ×œ×–×™×”×•×™ ××•×§×“× ×©×œ ×¡×™×›×•× ×™×. ×’×œ×• ×™×›×•×œ×•×ª ×™×™×‘×•× ×—×›××•×ª, × ×™×”×•×œ ×ª×œ××™×“×™× ××ª×§×“×, ×× ×œ×™×˜×™×§×” ××ª×§×“××ª ×•××¢×¨×›×ª ×”×ª×¨××•×ª ××•×˜×•××˜×™×ª! ğŸš€';
                
                showMessage(welcomeMessage, 'info');
            }, 1000);
        });
    </script>
</body>
</html>